<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title></title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="æ–°å»ºé¡¹ç›®"><a class="header" href="#æ–°å»ºé¡¹ç›®">æ–°å»ºé¡¹ç›®</a></h1>
<p>cargo æ˜¯ rust çš„åŒ…ç®¡ç†å™¨</p>
<p>ä½¿ç”¨cargoåˆå§‹åŒ–æ–°é¡¹ç›®</p>
<pre><code class="language-bash"># ä½¿ç”¨ cargo init åˆå§‹åŒ–é¡¹ç›®ï¼Œ. ç‚¹çš„ä½œç”¨æ˜¯ä»¥å½“å‰æ–‡ä»¶å¤¹ä¸ºåå­—æ¥åˆ›å»ºé¡¹ç›®
# cargo init é»˜è®¤ä¼šä»¥ package æ¥åˆ›å»ºæ–°é¡¹ç›®
# cargo init æ„æ€æ˜¯åœ¨ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª cargo package
cargo init .

# æŸ¥çœ‹tomlæ–‡ä»¶å†…å®¹
cat Cargo.toml

# æŸ¥çœ‹ init å‘½ä»¤å¸®åŠ©ä¿¡æ¯
cargo init --help

# ä»¥ lib å½¢å¼åˆå§‹åŒ–é¡¹ç›®
cargo init --lib .

# æŸ¥çœ‹ç›®å½•æ–‡ä»¶ç»“æ„
tree

# ä¿®æ”¹ test_example æ–‡ä»¶å¤¹åå­—ä¸º test_1
mv test_example test_1

# æŸ¥çœ‹ linux ç³»ç»Ÿç‰ˆæœ¬
cat /etc/os-release

</code></pre>
<p>ä¸‹é¢æ˜¯ cargo new</p>
<pre><code class="language-bash"># åœ¨ç»™å®šç›®å½•ä¸‹åˆ›å»ºæ–°çš„ cargo packageï¼Œé»˜è®¤å½“å‰ç›®å½•
cargo new foo

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å˜é‡"><a class="header" href="#å˜é‡">å˜é‡</a></h1>
<p>å£°æ˜å˜é‡å’Œæ§åˆ¶æµ</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // let é»˜è®¤åˆ›å»ºçš„å˜é‡éƒ½æ˜¯ä¸å¯å˜çš„
    let x = 200.0;
    // mut è®©å˜é‡å¯å˜
    let mut z = "haha";
    println!("{}", z);
    z = "hehe";

    let y = x / 2.2;
    println!("y = {}, z = {}", y, z);

    if x &gt; 199.0 {
        println!("bigger than 199");
    } else if x &gt; 150.0 {
        println!("bigger than 150");
    } else {
        println!("small");
    }
}</code></pre></pre>
<p>æ§åˆ¶æµè¡¨è¾¾å¼å’Œ shadowing</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut height = 200;
    height = height - 20;

    // æ»¡è¶³æ¡ä»¶åä¼šå°†å­—ç¬¦ä¸²çš„å€¼èµ‹å€¼ç»™ result å˜é‡
    let result = if height &gt; 100 {
        "tall"
    } else {
        "short"
    };

    println!("{}", result);

    // ä¸‹é¢æ˜¯æŠŠ if æ§åˆ¶æµè¯­å¥å†™åˆ°ä¸€è¡Œä¹‹å†…ï¼Œç±»ä¼¼è¡¨è¾¾å¼
    let health = if height &gt; 100 {"good"} else {"bad"};

    // é‡æ–°å£°æ˜ health å˜é‡ï¼Œè¿™å« éšè—ï¼ˆshadowingï¼‰
    let health = if height &gt; 100 {true} else {false};

    println!("{}", health);
}</code></pre></pre>
<p>æ‰€æœ‰æƒé—®é¢˜</p>
<pre><pre class="playground"><code class="language-rust">fn greet(s: String) {
    println!("Hello {s}");
}

fn main() {
    let name: String = "World".to_string();
    greet(name);
    greet(name);
}

/**
ç¬¬äºŒæ¬¡è°ƒç”¨greet(name)çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ‰€æœ‰æƒå‘ç”Ÿäº†å˜åŒ–
nameå˜é‡çš„æ‰€æœ‰æƒç”± main å‡½æ•°äº¤ç»™äº† greet å‡½æ•°ï¼Œå½“å†æ¬¡åœ¨ main å‡½æ•°ä¸­ä½¿ç”¨ name çš„æ—¶å€™ï¼Œå°±ä¼šæŠ¥é”™
error[E0382]: use of moved value: `name`
 --&gt; src/main.rs:8:11
  |
6 |     let name: String = "World".to_string();
  |         ---- move occurs because `name` has type `String`, which does not implement the `Copy` trait
7 |     greet(name);
  |           ---- value moved here
8 |     greet(name);
  |           ^^^^ value used here after move
*/
</code></pre></pre>
<p>ä¸‹é¢ä¾‹å­è§£å†³æ‰€æœ‰æƒé—®é¢˜ï¼Œé€šè¿‡å‡½æ•°çš„è¿”å›å€¼ï¼Œå°†æ‰€æœ‰æƒäº¤è¿˜ç»™åŸæ¥çš„å‡½æ•°</p>
<pre><pre class="playground"><code class="language-rust">fn greet(s: String) -&gt; String {
    println!("Hello {s}");
    s
}

fn main() {
    let name: String = "World".to_string();
    let name: String = greet(name);
    greet(name);
}

/**
greet å¤„ç† name åå°†å…¶è¿”å›ï¼Œç„¶åå†åˆ©ç”¨ shadowing å°† name å˜é‡é‡æ–°å£°æ˜
è¿™æ ·å°±æ„å‘³ç€ name çš„æ‰€æœ‰æƒæ˜¯è¿™æ ·å˜åŒ–çš„ï¼šmain -&gt; greet -&gt; main
**/</code></pre></pre>
<p>ä¸‹é¢ä¾‹å­ä½¿ç”¨å…‹éš†æ¥è§£å†³æ‰€æœ‰æƒé—®é¢˜</p>
<pre><pre class="playground"><code class="language-rust">fn greet(s: String) -&gt; String {
    println!("Hello {s}");
    s
}

fn main() {
    let name: String = "World".to_string();
    greet(name.clone());
    greet(name);
}

/**
clone æ“ä½œå¤åˆ¶äº†ä¸€ä»½å®Œæ•´çš„ name å˜é‡çš„å‰¯æœ¬ä¼ é€’ç»™ greet å‡½æ•°ï¼Œè§£å†³æ‰€æœ‰æƒé—®é¢˜
**/</code></pre></pre>
<p>å…‹éš†æ“ä½œæœ‰ç¼ºç‚¹ï¼Œå…‹éš†æ“ä½œè¿è¡Œèµ·æ¥å¯èƒ½ä¼šæ¯”è¾ƒæ…¢</p>
<p>ä¸‹é¢ä½¿ç”¨ &amp; å£°æ˜å¼•ç”¨ç±»å‹æ¥å€Ÿç”¨å˜é‡ï¼Œè€Œä¸æ˜¯æ‹¥æœ‰å˜é‡çš„æ‰€æœ‰æƒï¼Œå…¶å®å°±æ˜¯åˆ«çš„è¯­è¨€ä¸­çš„æŒ‡é’ˆ</p>
<pre><pre class="playground"><code class="language-rust">fn greet(s: String) -&gt; String {
    println!("Hello {s}");
    s
}

fn greet_borrow(s: &amp;String) {
    println!("{s}");
}

fn main() {
    let name: String = "World".to_string();
    greet_borrow(&amp;name);
    greet(name);
}

/**
è¿™æ ·çš„æŒ‡é’ˆæ— æ³•æ”¹å˜åŸæ¥å˜é‡çš„å€¼
**/</code></pre></pre>
<p>ä¸‹é¢æ˜¯å¯æ”¹å˜çš„æŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡è¿™ç§æŒ‡é’ˆæ”¹å˜åŸæ¥å˜é‡çš„å€¼</p>
<pre><pre class="playground"><code class="language-rust">fn greet(s: String) -&gt; String {
    println!("Hello {s}");
    s
}

fn greet_borrow_mut(s: &amp;mut String) {
    *s = format!("Hello {s}");
}

fn main() {
    let mut name: String = "World".to_string();
    greet_borrow_mut(&amp;mut name);
    greet(name);
}</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å¾ªç¯å’Œæ¡ä»¶"><a class="header" href="#å¾ªç¯å’Œæ¡ä»¶">å¾ªç¯å’Œæ¡ä»¶</a></h1>
<p>if let è¯­å¥å’Œæ¨¡å¼åŒ¹é…</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let a = Some(42);
    if let Some(number) = a {
        println!("number is {}", number);
    } else {
        println!("no number");
    }
}

/**
è¿™é‡Œä½¿ç”¨ if let è¯­å¥æ¥è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ŒSome æ˜¯ä¸€ç§ Optionç±»å‹ï¼Œä»£è¡¨æœ‰å¯èƒ½æœ‰å€¼ä¹Ÿæœ‰å¯èƒ½æ²¡å€¼çš„æƒ…å†µ

ç­‰å·åœ¨è¿™é‡Œä¸æ˜¯èµ‹å€¼ï¼Œè€Œæ˜¯æ¨¡å¼åŒ¹é…è¿ç®—ç¬¦ï¼Œå¦‚æœ a å’Œ Some(number) åŒ¹é…ä¸Šäº†ï¼Œä¹Ÿå°±æ˜¯æœ‰å€¼ï¼Œé‚£ä¹ˆå°±æ‰§è¡Œç¬¬ä¸€ä¸ªä»£ç å—ï¼Œå¦åˆ™å°±æ‰§è¡Œç¬¬äºŒä¸ªä»£ç å—
**/

/**
åœ¨Rustä¸­ï¼ŒOption æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œç”¨äºè¡¨ç¤ºä¸€ä¸ªå€¼å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨ã€‚Option æœ‰ä¸¤ä¸ªå˜ä½“ï¼šSome å’Œ Noneã€‚

Some(T)ï¼šè¡¨ç¤ºä¸€ä¸ªå€¼å­˜åœ¨ï¼Œå…¶ä¸­ T æ˜¯è¯¥å€¼çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼ŒSome(5) è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªæ•´æ•°å€¼ 5ï¼ŒSome("Hello") è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªå­—ç¬¦ä¸² "Hello"ã€‚

Noneï¼šè¡¨ç¤ºæ²¡æœ‰å€¼ã€‚
**/

fn main() {
    let a: Option&lt;Option&lt;()&gt;&gt; = Some(None);
    if let Some(number) = a {
        println!("number is {:?}", number);
    } else {
        println!("no number");
    }
}</code></pre></pre>
<p>loop å¾ªç¯</p>
<pre><pre class="playground"><code class="language-rust">
fn main() {
    let mut x = 1;
    loop {
        println!("x is {x}");
        x += 1;
        if x &gt; 5 {
            break;
        }
    }
}</code></pre></pre>
<p>while å¾ªç¯</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut i = 0;
    while i &lt; 5 {
        println!("i = {i}");
        i += 1;
    }
}</code></pre></pre>
<pre><pre class="playground"><code class="language-rust">use std::io;

fn main() {
    let mut input = String::new();

    while input.trim() != "stop" {
        input.clear();
        println!("Please enter a word, type 'stop' to exit: ");
        io::stdin().read_line(&amp;mut input).expect("Failed to read input");
        println!("Your entered: {}", input);
    }
    println!("Goodbye!");
}

/**
è®©ç”¨æˆ·ä¸åœåœ°åœ¨ç»ˆç«¯è¾“å…¥å­—ç¬¦ä¸²ï¼Œç›´åˆ°è¾“å…¥stopæ‰ä¼šåœæ­¢
**/

/**
trimæ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª&amp;strç±»å‹çš„å¼•ç”¨ï¼Œåœ¨Rustä¸­ï¼Œä½ å¯ä»¥ç›´æ¥å°†&amp;strç±»å‹çš„å¼•ç”¨ä¸å­—ç¬¦ä¸²å­—é¢é‡ï¼ˆå¦‚"stop"ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œå› ä¸ºå­—ç¬¦ä¸²å­—é¢é‡æœ¬èº«ä¹Ÿæ˜¯&amp;strç±»å‹
**/</code></pre></pre>
<p>for å¾ªç¯</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let a = [10, 20, 30, 40, 50];

    // å¾ªç¯ a æ•°ç»„
    for element in a {
        println!("the value is: {element}");
    }

    // 1..5 æ˜¯ä¸€ä¸ªèŒƒå›´ï¼ˆrangeï¼‰è¡¨ç¤ºä»æ•°å­— 1 åˆ°æ•°å­— 5ï¼ˆä¸åŒ…æ‹¬ 5ï¼‰çš„ä¸€ä¸ªåºåˆ—
    for i in 1..5 {
        println!("i = {i}");
    }

    // 1..=5 æ˜¯ä¸€ä¸ªåŒ…å«ç»“æŸå€¼çš„èŒƒå›´ï¼ˆinclusive rangeï¼‰ï¼Œè¡¨ç¤ºä»æ•°å­— 1 åˆ°æ•°å­— 5ï¼ˆåŒ…æ‹¬ 5ï¼‰çš„ä¸€ä¸ªåºåˆ—ã€‚è¿™ä¸ 1..5 çš„åŒºåˆ«åœ¨äºï¼Œ1..=5 åŒ…å«äº†ç»“æŸå€¼ 5ï¼Œè€Œ 1..5 ä¸åŒ…å«ç»“æŸå€¼ 5ã€‚
    for i in (1..=5).rev() {
        println!("i = {i}");
    }

    // vec å‘é‡ï¼Œç±»ä¼¼äºå…¶ä»–è¯­è¨€ä¸­çš„åˆ—è¡¨æˆ–è€…æ•°ç»„
    let numbers = vec![1, 2, 3, 4, 5];
    for n in numbers {
        println!("{n}");
    }
}

/**
å‘é‡æ˜¯ä¸€ç§åŠ¨æ€æ•°ç»„ï¼Œå¯ä»¥å­˜å‚¨å¤šä¸ªç›¸åŒç±»å‹çš„å…ƒç´ ã€‚å‘é‡å¯ä»¥å¢é•¿å’Œç¼©å°ï¼Œå¯ä»¥ç”¨äºå­˜å‚¨å’Œæ“ä½œæ•°æ®ã€‚

èŒƒå›´æ˜¯ä¸€ç§è¡¨ç¤ºä¸€ç³»åˆ—è¿ç»­æ•´æ•°çš„ç®€ä¾¿æ–¹å¼ã€‚èŒƒå›´é€šå¸¸ç”¨äºå¾ªç¯å’Œè¿­ä»£ï¼Œä½†å®ƒä»¬æœ¬èº«å¹¶ä¸å­˜å‚¨è¿™äº›æ•´æ•°ã€‚èŒƒå›´åªæ˜¯è¡¨ç¤ºäº†ä¸€ä¸ªå¼€å§‹å€¼å’Œä¸€ä¸ªç»“æŸå€¼ï¼ˆæœ‰æ—¶åŒ…å«ç»“æŸå€¼ï¼Œæœ‰æ—¶ä¸åŒ…å«ï¼‰ã€‚
**/</code></pre></pre>
<p>break å’Œ continue</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    for i in 1..=10 {
        if i % 2 == 0 {
            continue;
        }
        println!("i = {i}");
        if i == 7 {
            break;
        }
    }
}</code></pre></pre>
<p>match è¯­å¥</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let name = "Hello";

    match name {
        "Good Bye" =&gt; println!("Sorry to see you go."),
        "Hello" =&gt; println!("Hi, nice to meet you!"),
        _ =&gt; println!("I can't find a greeting, good bye."),
    }
}

/**
match è¯­å¥æœ‰ç‚¹ç±»ä¼¼ js ä¸­çš„ switch è¯­å¥ï¼Œä½†æ›´åŠ å¼ºå¤§
**/</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æ•°æ®ç±»å‹"><a class="header" href="#æ•°æ®ç±»å‹">æ•°æ®ç±»å‹</a></h1>
<h2 id="æ ‡é‡ç±»å‹scalarä¸€ä¸ªå•ç‹¬çš„å€¼æœ‰æ•´å‹æµ®ç‚¹å‹å¸ƒå°”å‹å­—ç¬¦å‹"><a class="header" href="#æ ‡é‡ç±»å‹scalarä¸€ä¸ªå•ç‹¬çš„å€¼æœ‰æ•´å‹æµ®ç‚¹å‹å¸ƒå°”å‹å­—ç¬¦å‹">æ ‡é‡ç±»å‹ï¼ˆscalarï¼‰ä¸€ä¸ªå•ç‹¬çš„å€¼ï¼Œæœ‰æ•´å‹ã€æµ®ç‚¹å‹ã€å¸ƒå°”å‹ã€å­—ç¬¦å‹</a></h2>
<h2 id="æ•´å‹"><a class="header" href="#æ•´å‹">æ•´å‹</a></h2>
<div class="table-wrapper"><table><thead><tr><th>é•¿åº¦</th><th>æœ‰ç¬¦å·</th><th>æ— ç¬¦å·</th></tr></thead><tbody>
<tr><td>8-bit</td><td>i8</td><td>u8</td></tr>
<tr><td>16-bit</td><td>i16</td><td>u16</td></tr>
<tr><td>32-bit</td><td>i32</td><td>u32</td></tr>
<tr><td>64-bit</td><td>i64</td><td>u64</td></tr>
<tr><td>128-bit</td><td>i128</td><td>u128</td></tr>
<tr><td>arch</td><td>isize</td><td>usize</td></tr>
</tbody></table>
</div>
<p>æœ‰ç¬¦å·çš„å˜ä½“å¯ä»¥å‚¨å­˜åŒ…å«ä» -2^(n - 1) åˆ° 2^(n - 1) - 1 åœ¨å†…çš„æ•°å­—ï¼Œè¿™é‡Œ n æ˜¯å˜ä½“ä½¿ç”¨çš„ä½æ•°ã€‚æ— ç¬¦å·çš„å˜ä½“å¯ä»¥å‚¨å­˜ä» 0 åˆ° 2^n - 1 çš„æ•°å­—</p>
<p>isize å’Œ usize ç±»å‹ä¾èµ–è¿è¡Œç¨‹åºçš„è®¡ç®—æœºæ¶æ„ï¼š64 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 64 ä½çš„ï¼Œ32 ä½æ¶æ„ä¸Šå®ƒä»¬æ˜¯ 32 ä½çš„ã€‚</p>
<div class="table-wrapper"><table><thead><tr><th>æ•°å­—å­—é¢å€¼</th><th>ä¾‹å­</th></tr></thead><tbody>
<tr><td>Decimal (åè¿›åˆ¶)</td><td>98_222</td></tr>
<tr><td>Hex (åå…­è¿›åˆ¶)</td><td>0xff</td></tr>
<tr><td>Octal (å…«è¿›åˆ¶)</td><td>0o77</td></tr>
<tr><td>Binary (äºŒè¿›åˆ¶)</td><td>0b1111_0000</td></tr>
<tr><td>Byte (å•å­—èŠ‚å­—ç¬¦)</td><td>b'A'</td></tr>
</tbody></table>
</div>
<p>åœ¨ Rust ä¸­ï¼Œb'A' æ˜¯ä¸€ä¸ªå­—èŠ‚å­—é¢é‡ï¼ˆbyte literalï¼‰ã€‚å®ƒè¡¨ç¤ºä¸€ä¸ª u8 ç±»å‹çš„å•å­—èŠ‚å­—ç¬¦ï¼Œå³ ASCII å­—ç¬¦ã€‚</p>
<p>b'A' çš„å€¼æ˜¯ 65ï¼Œè¿™æ˜¯å­—ç¬¦ 'A' åœ¨ ASCII è¡¨ä¸­çš„åè¿›åˆ¶å€¼ã€‚è¿™ç§å­—é¢é‡åªèƒ½ç”¨äº ASCII å­—ç¬¦ï¼ŒèŒƒå›´æ˜¯ 0 åˆ° 127ã€‚</p>
<p>å…è®¸ä½¿ç”¨ _ åšä¸ºåˆ†éš”ç¬¦ä»¥æ–¹ä¾¿è¯»æ•°ï¼Œä¾‹å¦‚1_000ï¼Œå®ƒçš„å€¼ä¸ä½ æŒ‡å®šçš„ 1000 ç›¸åŒã€‚</p>
<h3 id="æ•´å‹æº¢å‡º"><a class="header" href="#æ•´å‹æº¢å‡º">æ•´å‹æº¢å‡º</a></h3>
<p>å½“åœ¨ debug æ¨¡å¼ç¼–è¯‘æ—¶ï¼ŒRust ä¼šæ£€æŸ¥æ•´å‹æº¢å‡ºï¼Œè‹¥å­˜åœ¨è¿™äº›é—®é¢˜ï¼Œåˆ™ä½¿ç¨‹åºåœ¨ç¼–è¯‘æ—¶ panicã€‚</p>
<p>åœ¨å½“ä½¿ç”¨ --release å‚æ•°è¿›è¡Œ release æ¨¡å¼æ„å»ºæ—¶ï¼ŒRust ä¸æ£€æµ‹æº¢å‡ºã€‚ç›¸åï¼Œå½“æ£€æµ‹åˆ°æ•´å‹æº¢å‡ºæ—¶ï¼ŒRust ä¼šæŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºï¼ˆtwoâ€™s complement wrappingï¼‰çš„è§„åˆ™å¤„ç†ã€‚æ¯”å¦‚åœ¨ u8 çš„æƒ…å†µä¸‹ï¼Œ256 å˜æˆ 0ï¼Œ257 å˜æˆ 1ï¼Œä¾æ­¤ç±»æ¨ã€‚ç¨‹åºä¸ä¼š panicã€‚</p>
<p>è¦æ˜¾å¼å¤„ç†å¯èƒ½çš„æº¢å‡ºï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†åº“é’ˆå¯¹åŸå§‹æ•°å­—ç±»å‹æä¾›çš„è¿™äº›æ–¹æ³•ï¼š</p>
<p>ä½¿ç”¨ wrapping_* æ–¹æ³•åœ¨æ‰€æœ‰æ¨¡å¼ä¸‹éƒ½æŒ‰ç…§è¡¥ç å¾ªç¯æº¢å‡ºè§„åˆ™å¤„ç†ï¼Œä¾‹å¦‚ wrapping_add<br />
å¦‚æœä½¿ç”¨ checked_* æ–¹æ³•æ—¶å‘ç”Ÿæº¢å‡ºï¼Œåˆ™è¿”å› None å€¼<br />
ä½¿ç”¨ overflowing_* æ–¹æ³•è¿”å›è¯¥å€¼å’Œä¸€ä¸ªæŒ‡ç¤ºæ˜¯å¦å­˜åœ¨æº¢å‡ºçš„å¸ƒå°”å€¼<br />
ä½¿ç”¨ saturating_* æ–¹æ³•ï¼Œå¯ä»¥é™å®šè®¡ç®—åçš„ç»“æœä¸è¶…è¿‡ç›®æ ‡ç±»å‹çš„æœ€å¤§å€¼æˆ–ä½äºæœ€å°å€¼ï¼Œä¾‹å¦‚:</p>
<pre><pre class="playground"><code class="language-rust">assert_eq!(100u8.saturating_add(1), 101);
assert_eq!(u8::MAX.saturating_add(127), u8::MAX);

fn main() {
    let a : u8 = 255;
    let b = a.wrapping_add(20);
    println!("{}", b);  // 19
}</code></pre></pre>
<h2 id="æµ®ç‚¹å‹"><a class="header" href="#æµ®ç‚¹å‹">æµ®ç‚¹å‹</a></h2>
<p>Rust çš„æµ®ç‚¹æ•°ç±»å‹æ˜¯ f32 å’Œ f64ï¼Œåˆ†åˆ«å  32 ä½å’Œ 64 ä½ã€‚f32 æ˜¯å•ç²¾åº¦æµ®ç‚¹æ•°ï¼Œf64 æ˜¯åŒç²¾åº¦æµ®ç‚¹æ•°ã€‚</p>
<h3 id="æµ®ç‚¹æ•°é™·é˜±"><a class="header" href="#æµ®ç‚¹æ•°é™·é˜±">æµ®ç‚¹æ•°é™·é˜±</a></h3>
<ol>
<li>æµ®ç‚¹æ•°å¾€å¾€æ˜¯ä½ æƒ³è¦æ•°å­—çš„è¿‘ä¼¼è¡¨è¾¾</li>
<li>æµ®ç‚¹æ•°åœ¨æŸäº›ç‰¹æ€§ä¸Šæ˜¯åç›´è§‰çš„</li>
</ol>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let abc: (f32, f32, f32) = (0.1, 0.2, 0.3);
    let xyz: (f64, f64, f64) = (0.1, 0.2, 0.3);

    println!("abc (f32)");
    println!("   0.1 + 0.2: {:x}", (abc.0 + abc.1).to_bits());
    println!("         0.3: {:x}", (abc.2).to_bits());
    println!();

    println!("xyz (f64)");
    println!("   0.1 + 0.2: {:x}", (xyz.0 + xyz.1).to_bits());
    println!("         0.3: {:x}", (xyz.2).to_bits());
    println!();

    assert!(abc.0 + abc.1 == abc.2);
    assert!(xyz.0 + xyz.1 == xyz.2);
}


// abc (f32)
//    0.1 + 0.2: 3e99999a
//          0.3: 3e99999a

// xyz (f64)
//    0.1 + 0.2: 3fd3333333333334
//          0.3: 3fd3333333333333

// thread 'main' panicked at 'assertion failed: xyz.0 + xyz.1 == xyz.2',
// â¥ch2-add-floats.rs.rs:14:5
// note: run with `RUST_BACKTRACE=1` environment variable to display
// â¥a backtrace

// f32 çš„æ—¶å€™ï¼Œ0.1 + 0.2 å’Œ 0.3 æ˜¯ç›¸ç­‰çš„ï¼›f64 çš„æ—¶å€™ï¼Œ0.1 + 0.2 å’Œ 0.3 ä¸ç›¸ç­‰äº†</code></pre></pre>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let v: u16 = 38_u8 as u16;
}

// 38_u8 è¡¨ç¤ºä¸€ä¸ª u8 ç±»å‹çš„å€¼ 38
// as u16 æ˜¯ä¸€ä¸ªç±»å‹è½¬æ¢æ“ä½œï¼Œå°† u8 ç±»å‹çš„å€¼è½¬æ¢ä¸º u16 ç±»å‹</code></pre></pre>
<h2 id="nan"><a class="header" href="#nan">NaN</a></h2>
<p>å¯¹äºæ•°å­¦ä¸Šæœªå®šä¹‰çš„ç»“æœï¼Œä¾‹å¦‚å¯¹è´Ÿæ•°å–å¹³æ–¹æ ¹ -42.1.sqrt() ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªç‰¹æ®Šçš„ç»“æœï¼šRust çš„æµ®ç‚¹æ•°ç±»å‹ä½¿ç”¨ NaN (not a number) æ¥å¤„ç†è¿™äº›æƒ…å†µã€‚</p>
<p>æ‰€æœ‰è·Ÿ NaN äº¤äº’çš„æ“ä½œï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ª NaNï¼ŒNaN ä¸èƒ½ç”¨æ¥æ¯”è¾ƒï¼Œä¸‹é¢çš„ä»£ç ä¼šå´©æºƒ</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
  let x = (-42.0_f32).sqrt();
  assert_eq!(x, x);
}
</code></pre></pre>
<p>å¯ä»¥ä½¿ç”¨ is_nan() ç­‰æ–¹æ³•ï¼Œå¯ä»¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å€¼æ˜¯å¦æ˜¯ NaN ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let x = (-42.0_f32).sqrt();
    if x.is_nan() {
        println!("æœªå®šä¹‰çš„æ•°å­¦è¡Œä¸º")
    }
}</code></pre></pre>
<h2 id="è¿ç®—"><a class="header" href="#è¿ç®—">è¿ç®—</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
  // ç¼–è¯‘å™¨ä¼šè¿›è¡Œè‡ªåŠ¨æ¨å¯¼ï¼Œç»™äºˆtwenty i32çš„ç±»å‹
  let twenty = 20;
  // ç±»å‹æ ‡æ³¨
  let twenty_one: i32 = 21;
  // é€šè¿‡ç±»å‹åç¼€çš„æ–¹å¼è¿›è¡Œç±»å‹æ ‡æ³¨ï¼š22æ˜¯i32ç±»å‹
  let twenty_two = 22i32;

  // åªæœ‰åŒæ ·ç±»å‹ï¼Œæ‰èƒ½è¿ç®—
  let addition = twenty + twenty_one + twenty_two;
  println!("{} + {} + {} = {}", twenty, twenty_one, twenty_two, addition);

  // å¯¹äºè¾ƒé•¿çš„æ•°å­—ï¼Œå¯ä»¥ç”¨_è¿›è¡Œåˆ†å‰²ï¼Œæå‡å¯è¯»æ€§
  let one_million: i64 = 1_000_000;
  println!("{}", one_million.pow(2));

  // å®šä¹‰ä¸€ä¸ªf32æ•°ç»„ï¼Œå…¶ä¸­42.0ä¼šè‡ªåŠ¨è¢«æ¨å¯¼ä¸ºf32ç±»å‹
  let forty_twos = [
    42.0,
    42f32,
    42.0_f32,
  ];

  // æ‰“å°æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå€¼ï¼Œå¹¶æ§åˆ¶å°æ•°ä½ä¸º2ä½
  println!("{:.2}", forty_twos[0]);
}</code></pre></pre>
<h2 id="åºåˆ—range"><a class="header" href="#åºåˆ—range">åºåˆ—(Range)</a></h2>
<p>Rust æä¾›äº†ä¸€ä¸ªéå¸¸ç®€æ´çš„æ–¹å¼ï¼Œç”¨æ¥ç”Ÿæˆè¿ç»­çš„æ•°å€¼ï¼Œä¾‹å¦‚ 1..5ï¼Œç”Ÿæˆä» 1 åˆ° 4 çš„è¿ç»­æ•°å­—ï¼Œä¸åŒ…å« 5 ï¼›1..=5ï¼Œç”Ÿæˆä» 1 åˆ° 5 çš„è¿ç»­æ•°å­—ï¼ŒåŒ…å« 5</p>
<p>åºåˆ—åªå…è®¸ç”¨äºæ•°å­—æˆ–å­—ç¬¦ç±»å‹ï¼ŒåŸå› æ˜¯ï¼šå®ƒä»¬å¯ä»¥è¿ç»­ï¼ŒåŒæ—¶ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æœŸå¯ä»¥æ£€æŸ¥è¯¥åºåˆ—æ˜¯å¦ä¸ºç©ºï¼Œå­—ç¬¦å’Œæ•°å­—å€¼æ˜¯ Rust ä¸­ä»…æœ‰çš„å¯ä»¥ç”¨äºåˆ¤æ–­æ˜¯å¦ä¸ºç©ºçš„ç±»å‹ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>for i in 1..=5 {
    println!("{}",i);
}

// 1
// 2
// 3
// 4
// 5

for i in 'a'..='z' {
    println!("{}",i);
}
<span class="boring">}</span></code></pre></pre>
<h2 id="å¸ƒå°”å‹"><a class="header" href="#å¸ƒå°”å‹">å¸ƒå°”å‹</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}</code></pre></pre>
<p>å¸ƒå°”ç±»å‹å ç”¨ 1 ä¸ªå­—èŠ‚</p>
<h2 id="å­—ç¬¦å‹"><a class="header" href="#å­—ç¬¦å‹">å­—ç¬¦å‹</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // with explicit type annotation
    let heart_eyed_cat = 'ğŸ˜»';
}</code></pre></pre>
<p>æˆ‘ä»¬ç”¨å•å¼•å·å£°æ˜ char å­—é¢é‡ï¼Œè€Œä¸ä¹‹ç›¸åçš„æ˜¯ï¼Œä½¿ç”¨åŒå¼•å·å£°æ˜å­—ç¬¦ä¸²å­—é¢é‡ã€‚å­—ç¬¦ç±»å‹å ç”¨ 4 ä¸ªå­—èŠ‚</p>
<h2 id="å¤åˆç±»å‹compound-typeså¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹rust-æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹å…ƒç»„tupleå’Œæ•°ç»„array"><a class="header" href="#å¤åˆç±»å‹compound-typeså¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹rust-æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹å…ƒç»„tupleå’Œæ•°ç»„array">å¤åˆç±»å‹ï¼ˆCompound typesï¼‰å¯ä»¥å°†å¤šä¸ªå€¼ç»„åˆæˆä¸€ä¸ªç±»å‹ã€‚Rust æœ‰ä¸¤ä¸ªåŸç”Ÿçš„å¤åˆç±»å‹ï¼šå…ƒç»„ï¼ˆtupleï¼‰å’Œæ•°ç»„ï¼ˆarrayï¼‰ã€‚</a></h2>
<h2 id="å…ƒç»„"><a class="header" href="#å…ƒç»„">å…ƒç»„</a></h2>
<p>å…ƒç»„é•¿åº¦å›ºå®šï¼šä¸€æ—¦å£°æ˜ï¼Œå…¶é•¿åº¦ä¸ä¼šå¢å¤§æˆ–ç¼©å°ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    // å…ƒç»„çš„è§£æ„
    let (x, y, z) = tup;


    // ç”¨.ç‚¹å·æ¥è®¿é—®å…ƒç»„çš„æˆå‘˜
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}</code></pre></pre>
<p>ä¸å¸¦ä»»ä½•å€¼çš„å…ƒç»„æœ‰ä¸ªç‰¹æ®Šçš„åç§°ï¼Œå«åš å•å…ƒï¼ˆunitï¼‰ å…ƒç»„ã€‚è¿™ç§å€¼ä»¥åŠå¯¹åº”çš„ç±»å‹éƒ½å†™ä½œ ()ï¼Œè¡¨ç¤ºç©ºå€¼æˆ–ç©ºçš„è¿”å›ç±»å‹ã€‚å¦‚æœè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å…¶ä»–å€¼ï¼Œåˆ™ä¼šéšå¼è¿”å›å•å…ƒå€¼ã€‚</p>
<h2 id="æ•°ç»„"><a class="header" href="#æ•°ç»„">æ•°ç»„</a></h2>
<p>Rust ä¸­çš„æ•°ç»„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ çš„ç±»å‹å¿…é¡»ç›¸åŒã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// i32 æ˜¯æ¯ä¸ªå…ƒç´ çš„ç±»å‹ã€‚åˆ†å·ä¹‹åï¼Œæ•°å­— 5 è¡¨æ˜è¯¥æ•°ç»„åŒ…å«äº”ä¸ªå…ƒç´ ã€‚
let a: [i32; 5] = [1, 2, 3, 4, 5];

// å˜é‡åä¸º a çš„æ•°ç»„å°†åŒ…å« 5 ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„å€¼æœ€åˆéƒ½å°†è¢«è®¾ç½®ä¸º 3ã€‚
let a = [3; 5];
<span class="boring">}</span></code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å‡½æ•°"><a class="header" href="#å‡½æ•°">å‡½æ•°</a></h1>
<h2 id="è¯­å¥å’Œè¡¨è¾¾å¼"><a class="header" href="#è¯­å¥å’Œè¡¨è¾¾å¼">è¯­å¥å’Œè¡¨è¾¾å¼</a></h2>
<p>è¯­å¥æ˜¯ä¸è¿”å›å€¼çš„æŒ‡ä»¤ã€‚ è¡¨è¾¾å¼è¿”å›ä¸€ä¸ªå€¼ã€‚è¡¨è¾¾å¼çš„ç»“å°¾æ²¡æœ‰åˆ†å·ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let y = {
        let x = 3;
        x + 1
    };

    println!("The value of y is: {y}");
}

fn five() -&gt; i32 {
    5
}

fn main() {
    let x = five();

    println!("The value of x is: {x}");
}</code></pre></pre>
<h2 id="ç‰¹æ®Šè¿”å›å€¼"><a class="header" href="#ç‰¹æ®Šè¿”å›å€¼">ç‰¹æ®Šè¿”å›å€¼</a></h2>
<ul>
<li>å‡½æ•°æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆè¿”å›ä¸€ä¸ª ()</li>
<li>å½“ç”¨ ! ä½œå‡½æ•°è¿”å›ç±»å‹çš„æ—¶å€™ï¼Œè¡¨ç¤ºè¯¥å‡½æ•°æ°¸ä¸è¿”å›ã€‚ä¾‹å¦‚å´©æºƒçš„å‡½æ•°å’Œæ— é™å¾ªç¯çš„å‡½æ•°</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æ‰€æœ‰æƒ"><a class="header" href="#æ‰€æœ‰æƒ">æ‰€æœ‰æƒ</a></h1>
<h2 id="æ ˆstackä¸å †heap"><a class="header" href="#æ ˆstackä¸å †heap">æ ˆï¼ˆStackï¼‰ä¸å †ï¼ˆHeapï¼‰</a></h2>
<p>æ ˆä¸­çš„æ‰€æœ‰æ•°æ®éƒ½å¿…é¡»å ç”¨å·²çŸ¥ä¸”å›ºå®šçš„å¤§å°ã€‚åœ¨ç¼–è¯‘æ—¶å¤§å°æœªçŸ¥æˆ–å¤§å°å¯èƒ½å˜åŒ–çš„æ•°æ®ï¼Œè¦æ”¹ä¸ºå­˜å‚¨åœ¨å †ä¸Šã€‚ å †æ˜¯ç¼ºä¹ç»„ç»‡çš„ï¼šå½“å‘å †æ”¾å…¥æ•°æ®æ—¶ï¼Œä½ è¦è¯·æ±‚ä¸€å®šå¤§å°çš„ç©ºé—´ã€‚å†…å­˜åˆ†é…å™¨ï¼ˆmemory allocatorï¼‰åœ¨å †çš„æŸå¤„æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºä½ï¼ŒæŠŠå®ƒæ ‡è®°ä¸ºå·²ä½¿ç”¨ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¡¨ç¤ºè¯¥ä½ç½®åœ°å€çš„ æŒ‡é’ˆï¼ˆpointerï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä½œ åœ¨å †ä¸Šåˆ†é…å†…å­˜ï¼ˆallocating on the heapï¼‰ï¼Œæœ‰æ—¶ç®€ç§°ä¸º â€œåˆ†é…â€ï¼ˆallocatingï¼‰ã€‚</p>
<p>å½“ä½ çš„ä»£ç è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œä¼ é€’ç»™å‡½æ•°çš„å€¼ï¼ˆåŒ…æ‹¬å¯èƒ½æŒ‡å‘å †ä¸Šæ•°æ®çš„æŒ‡é’ˆï¼‰å’Œå‡½æ•°çš„å±€éƒ¨å˜é‡è¢«å‹å…¥æ ˆä¸­ã€‚å½“å‡½æ•°ç»“æŸæ—¶ï¼Œè¿™äº›å€¼è¢«ç§»å‡ºæ ˆã€‚</p>
<p><strong>è·Ÿè¸ªå“ªéƒ¨åˆ†ä»£ç æ­£åœ¨ä½¿ç”¨å †ä¸Šçš„å“ªäº›æ•°æ®ï¼Œæœ€å¤§é™åº¦çš„å‡å°‘å †ä¸Šçš„é‡å¤æ•°æ®çš„æ•°é‡ï¼Œä»¥åŠæ¸…ç†å †ä¸Šä¸å†ä½¿ç”¨çš„æ•°æ®ç¡®ä¿ä¸ä¼šè€—å°½ç©ºé—´ï¼Œè¿™äº›é—®é¢˜æ­£æ˜¯æ‰€æœ‰æƒç³»ç»Ÿè¦å¤„ç†çš„ã€‚æ‰€æœ‰æƒçš„ä¸»è¦ç›®çš„å°±æ˜¯ç®¡ç†å †æ•°æ®ã€‚</strong></p>
<h2 id="æ‰€æœ‰æƒ-1"><a class="header" href="#æ‰€æœ‰æƒ-1">æ‰€æœ‰æƒ</a></h2>
<p>Rust ä¸­çš„æ¯ä¸€ä¸ªå€¼éƒ½æœ‰ä¸€ä¸ª æ‰€æœ‰è€…ï¼ˆownerï¼‰ã€‚
å€¼åœ¨ä»»ä¸€æ—¶åˆ»æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚
å½“æ‰€æœ‰è€…ï¼ˆå˜é‡ï¼‰ç¦»å¼€ä½œç”¨åŸŸï¼Œè¿™ä¸ªå€¼å°†è¢«ä¸¢å¼ƒã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span> {
        let s = String::from("hello"); // ä»æ­¤å¤„èµ·ï¼Œs æ˜¯æœ‰æ•ˆçš„

        // ä½¿ç”¨ s
    }                                  // æ­¤ä½œç”¨åŸŸå·²ç»“æŸï¼Œ
                                       // s ä¸å†æœ‰æ•ˆ
<span class="boring">}</span></code></pre></pre>
<p>å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸï¼ŒRust ä¸ºæˆ‘ä»¬è°ƒç”¨ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°å«åš dropï¼Œåœ¨è¿™é‡Œ String çš„ä½œè€…å¯ä»¥æ”¾ç½®é‡Šæ”¾å†…å­˜çš„ä»£ç ã€‚Rust åœ¨ç»“å°¾çš„ } å¤„è‡ªåŠ¨è°ƒç”¨ dropã€‚</p>
<h2 id="ç®€å•ä»‹ç»-string-ç±»å‹"><a class="header" href="#ç®€å•ä»‹ç»-string-ç±»å‹">ç®€å•ä»‹ç» string ç±»å‹</a></h2>
<h2 id="ç§»åŠ¨"><a class="header" href="#ç§»åŠ¨">ç§»åŠ¨</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>    // å°† 5 ç»‘å®šåˆ° xï¼›æ¥ç€ç”Ÿæˆä¸€ä¸ªå€¼ x çš„æ‹·è´å¹¶ç»‘å®šåˆ° y å› ä¸ºæ•´æ•°æ˜¯æœ‰å·²çŸ¥å›ºå®šå¤§å°çš„ç®€å•å€¼ï¼Œæ‰€ä»¥è¿™ä¸¤ä¸ª 5 è¢«æ”¾å…¥äº†æ ˆä¸­
    // åƒ i32 è¿™ç§æ•°å­—ç±»å‹æ˜¯ç®€å•ç±»å‹ï¼Œæ‰€ä»¥èµ‹å€¼çš„æ—¶å€™æ˜¯ç›´æ¥æ‹·è´çš„ï¼Œç„¶åå­˜åœ¨æ ˆä¸­
    let x = 5;
    let y = x;

    // String è¿™ç§å¤æ‚ç±»å‹ï¼Œä¸ä¼šæ‹·è´å †ä¸Šçš„å€¼
    // å¤åˆ¶äº†æŒ‡é’ˆï¼Œé•¿åº¦ï¼Œå®¹é‡ï¼Œå¹¶ä¸ä¼šå¤åˆ¶å †ä¸Šçš„æ•°æ®
    // å¦‚æœå¤åˆ¶äº†å †ä¸Šçš„æ•°æ®ï¼Œå †ä¸Šæ•°æ®æ¯”è¾ƒå¤§çš„æ—¶å€™ä¼šå¯¹è¿è¡Œæ—¶æ€§èƒ½é€ æˆéå¸¸å¤§çš„å½±å“
    let s1 = String::from("hello");
    let s2 = s1;
<span class="boring">}</span></code></pre></pre>
<p><img src="base/./img/trpl04-01.svg" alt="trpl04-01" /></p>
<p>å½“å˜é‡ç¦»å¼€ä½œç”¨åŸŸåï¼ŒRust è‡ªåŠ¨è°ƒç”¨ drop å‡½æ•°å¹¶æ¸…ç†å˜é‡çš„å †å†…å­˜ã€‚è¿™å°±æœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼šå½“ s2 å’Œ s1 ç¦»å¼€ä½œç”¨åŸŸï¼Œå®ƒä»¬éƒ½ä¼šå°è¯•é‡Šæ”¾ç›¸åŒçš„å†…å­˜ã€‚è¿™æ˜¯ä¸€ä¸ªå«åš äºŒæ¬¡é‡Šæ”¾ï¼ˆdouble freeï¼‰çš„é”™è¯¯ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let s1 = String::from("hello");
    let s2 = s1;

    println!("{s1}, world!");

    // Compiling ownership v0.1.0 (file:///projects/ownership)
    // error[E0382]: borrow of moved value: `s1`
<span class="boring">}</span></code></pre></pre>
<p><img src="base/./img/trpl04-04.svg" alt="trpl04-04" /></p>
<p>Rust ä½¿ç¬¬ä¸€ä¸ªå˜é‡æ— æ•ˆäº†ï¼Œè¿™ä¸ªæ“ä½œè¢«ç§°ä¸º ç§»åŠ¨ï¼ˆmoveï¼‰ã€‚ä¸Šé¢çš„ä¾‹å­å¯ä»¥è§£è¯»ä¸º s1 è¢« ç§»åŠ¨ åˆ°äº† s2 ä¸­ã€‚</p>
<h2 id="å…‹éš†"><a class="header" href="#å…‹éš†">å…‹éš†</a></h2>
<p>å¦‚æœæˆ‘ä»¬ ç¡®å® éœ€è¦æ·±åº¦å¤åˆ¶ String ä¸­å †ä¸Šçš„æ•°æ®ï¼Œè€Œä¸ä»…ä»…æ˜¯æ ˆä¸Šçš„æ•°æ®ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªå«åš clone çš„é€šç”¨å‡½æ•°ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let s1 = String::from("hello");
    let s2 = s1.clone();

    println!("s1 = {s1}, s2 = {s2}");
<span class="boring">}</span></code></pre></pre>
<p>Rust æœ‰ä¸€ä¸ªå«åš Copy trait çš„ç‰¹æ®Šæ³¨è§£ï¼Œå¯ä»¥ç”¨åœ¨ç±»ä¼¼æ•´å‹è¿™æ ·çš„å­˜å‚¨åœ¨æ ˆä¸Šçš„ç±»å‹ä¸Šã€‚å¦‚æœä¸€ä¸ªç±»å‹å®ç°äº† Copy traitï¼Œé‚£ä¹ˆä¸€ä¸ªæ—§çš„å˜é‡åœ¨å°†å…¶èµ‹å€¼ç»™å…¶ä»–å˜é‡åä»ç„¶å¯ç”¨ã€‚</p>
<p>Rust ä¸å…è®¸è‡ªèº«æˆ–å…¶ä»»ä½•éƒ¨åˆ†å®ç°äº† Drop trait çš„ç±»å‹ä½¿ç”¨ Copy traitã€‚å¦‚æœæˆ‘ä»¬å¯¹å…¶å€¼ç¦»å¼€ä½œç”¨åŸŸæ—¶éœ€è¦ç‰¹æ®Šå¤„ç†çš„ç±»å‹ä½¿ç”¨ Copy æ³¨è§£ï¼Œå°†ä¼šå‡ºç°ä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯ã€‚</p>
<p>ä»»ä½•ä¸€ç»„ç®€å•æ ‡é‡å€¼çš„ç»„åˆéƒ½å¯ä»¥å®ç° Copyï¼Œä»»ä½•ä¸éœ€è¦åˆ†é…å†…å­˜æˆ–æŸç§å½¢å¼èµ„æºçš„ç±»å‹éƒ½å¯ä»¥å®ç° Copy ã€‚å¦‚ä¸‹æ˜¯ä¸€äº› Copy çš„ç±»å‹ï¼š</p>
<ul>
<li>æ‰€æœ‰æ•´æ•°ç±»å‹ï¼Œæ¯”å¦‚ u32ã€‚</li>
<li>å¸ƒå°”ç±»å‹ï¼Œboolï¼Œå®ƒçš„å€¼æ˜¯ true å’Œ falseã€‚</li>
<li>æ‰€æœ‰æµ®ç‚¹æ•°ç±»å‹ï¼Œæ¯”å¦‚ f64ã€‚</li>
<li>å­—ç¬¦ç±»å‹ï¼Œcharã€‚</li>
<li>å…ƒç»„ï¼Œå½“ä¸”ä»…å½“å…¶åŒ…å«çš„ç±»å‹ä¹Ÿéƒ½å®ç° Copy çš„æ—¶å€™ã€‚æ¯”å¦‚ï¼Œ(i32, i32) å®ç°äº† Copyï¼Œä½† (i32, String) å°±æ²¡æœ‰ã€‚</li>
<li>ä¸å¯å˜å¼•ç”¨ &amp;T ï¼Œä½†æ˜¯æ³¨æ„ï¼šå¯å˜å¼•ç”¨ &amp;mut T æ˜¯ä¸å¯ä»¥ Copy çš„</li>
</ul>
<h2 id="æ‰€æœ‰æƒä¸å‡½æ•°"><a class="header" href="#æ‰€æœ‰æƒä¸å‡½æ•°">æ‰€æœ‰æƒä¸å‡½æ•°</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let s = String::from("hello");  // s è¿›å…¥ä½œç”¨åŸŸ

    takes_ownership(s);             // s çš„å€¼ç§»åŠ¨åˆ°å‡½æ•°é‡Œ ...
                                    // ... æ‰€ä»¥åˆ°è¿™é‡Œä¸å†æœ‰æ•ˆ

    let x = 5;                      // x è¿›å…¥ä½œç”¨åŸŸ

    makes_copy(x);                  // x åº”è¯¥ç§»åŠ¨å‡½æ•°é‡Œï¼Œ
                                    // ä½† i32 æ˜¯ Copy çš„ï¼Œ
                                    // æ‰€ä»¥åœ¨åé¢å¯ç»§ç»­ä½¿ç”¨ x

} // è¿™é‡Œï¼Œx å…ˆç§»å‡ºäº†ä½œç”¨åŸŸï¼Œç„¶åæ˜¯ sã€‚ä½†å› ä¸º s çš„å€¼å·²è¢«ç§»èµ°ï¼Œ
  // æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„

fn takes_ownership(some_string: String) { // some_string è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_string);
} // è¿™é‡Œï¼Œsome_string ç§»å‡ºä½œç”¨åŸŸå¹¶è°ƒç”¨ `drop` æ–¹æ³•ã€‚
  // å ç”¨çš„å†…å­˜è¢«é‡Šæ”¾

fn makes_copy(some_integer: i32) { // some_integer è¿›å…¥ä½œç”¨åŸŸ
    println!("{}", some_integer);
} // è¿™é‡Œï¼Œsome_integer ç§»å‡ºä½œç”¨åŸŸã€‚æ²¡æœ‰ç‰¹æ®Šä¹‹å¤„</code></pre></pre>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let s1 = gives_ownership();         // gives_ownership å°†è¿”å›å€¼
                                        // è½¬ç§»ç»™ s1

    let s2 = String::from("hello");     // s2 è¿›å…¥ä½œç”¨åŸŸ

    let s3 = takes_and_gives_back(s2);  // s2 è¢«ç§»åŠ¨åˆ°
                                        // takes_and_gives_back ä¸­ï¼Œ
                                        // å®ƒä¹Ÿå°†è¿”å›å€¼ç§»ç»™ s3
} // è¿™é‡Œï¼Œs3 ç§»å‡ºä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚s2 ä¹Ÿç§»å‡ºä½œç”¨åŸŸï¼Œä½†å·²è¢«ç§»èµ°ï¼Œ
  // æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿã€‚s1 ç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒ

fn gives_ownership() -&gt; String {             // gives_ownership ä¼šå°†
                                             // è¿”å›å€¼ç§»åŠ¨ç»™
                                             // è°ƒç”¨å®ƒçš„å‡½æ•°

    let some_string = String::from("yours"); // some_string è¿›å…¥ä½œç”¨åŸŸã€‚

    some_string                              // è¿”å› some_string
                                             // å¹¶ç§»å‡ºç»™è°ƒç”¨çš„å‡½æ•°
                                             //
}

// takes_and_gives_back å°†ä¼ å…¥å­—ç¬¦ä¸²å¹¶è¿”å›è¯¥å€¼
fn takes_and_gives_back(a_string: String) -&gt; String { // a_string è¿›å…¥ä½œç”¨åŸŸ
                                                      //

    a_string  // è¿”å› a_string å¹¶ç§»å‡ºç»™è°ƒç”¨çš„å‡½æ•°
}</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å¼•ç”¨ä¸å€Ÿç”¨"><a class="header" href="#å¼•ç”¨ä¸å€Ÿç”¨">å¼•ç”¨ä¸å€Ÿç”¨</a></h1>
<h2 id="å¼•ç”¨"><a class="header" href="#å¼•ç”¨">å¼•ç”¨</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let s1 = String::from("hello");

    let len = calculate_length(&amp;s1);

    println!("The length of '{s1}' is {len}.");
}

fn calculate_length(s: &amp;String) -&gt; usize { // s æ˜¯ String çš„å¼•ç”¨
    s.len()
}  // è¿™é‡Œï¼Œs ç¦»å¼€äº†ä½œç”¨åŸŸã€‚ä½†å› ä¸ºå®ƒå¹¶ä¸æ‹¥æœ‰å¼•ç”¨å€¼çš„æ‰€æœ‰æƒï¼Œ
  // æ‰€ä»¥ä»€ä¹ˆä¹Ÿä¸ä¼šå‘ç”Ÿ</code></pre></pre>
<p>ä¸Šé¢ä¾‹å­ä¸­çš„è¿™äº› &amp; ç¬¦å·å°±æ˜¯ å¼•ç”¨ï¼Œå®ƒä»¬å…è®¸ä½ ä½¿ç”¨å€¼ä½†ä¸è·å–å…¶æ‰€æœ‰æƒã€‚åˆ›å»ºä¸€ä¸ªå¼•ç”¨çš„è¡Œä¸ºè¢«ç§°ä¸º å€Ÿç”¨ï¼ˆborrowingï¼‰ã€‚</p>
<p><img src="base/./img/trpl04-05.svg" alt="trpl04-05" /></p>
<p>å¦‚æœä¿®æ”¹å€Ÿç”¨çš„å˜é‡ï¼Œä¼šæŠ¥é”™ã€‚</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let s = String::from("hello");

    change(&amp;s);
}

fn change(some_string: &amp;String) {
    some_string.push_str(", world"); // ä¼šæŠ¥é”™ ï¼ˆé»˜è®¤ï¼‰ä¸å…è®¸ä¿®æ”¹å¼•ç”¨çš„å€¼
}</code></pre></pre>
<h1 id="å¯å˜å¼•ç”¨"><a class="header" href="#å¯å˜å¼•ç”¨">å¯å˜å¼•ç”¨</a></h1>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut s = String::from("hello");

    change(&amp;mut s);
}

fn change(some_string: &amp;mut String) {
    some_string.push_str(", world");
}</code></pre></pre>
<p>å¯å˜å¼•ç”¨æœ‰ä¸€ä¸ªå¾ˆå¤§çš„é™åˆ¶ï¼šå¦‚æœä½ æœ‰ä¸€ä¸ªå¯¹è¯¥å˜é‡çš„å¯å˜å¼•ç”¨ï¼Œä½ å°±ä¸èƒ½å†åˆ›å»ºå¯¹è¯¥å˜é‡çš„å¼•ç”¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let mut s = String::from("hello");

    let r1 = &amp;mut s;
    let r2 = &amp;mut s;

    println!("{}, {}", r1, r2); // cannot borrow `s` as mutable more than once at a time æŠ¥é”™äº†
    // ä¸èƒ½åœ¨åŒä¸€æ—¶é—´å¤šæ¬¡å°† s ä½œä¸ºå¯å˜å˜é‡å€Ÿç”¨

<span class="boring">}</span></code></pre></pre>
<p>è¿™ä¸€é™åˆ¶ä»¥ä¸€ç§éå¸¸å°å¿ƒè°¨æ…çš„æ–¹å¼å…è®¸å¯å˜æ€§ï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¯¹åŒä¸€æ•°æ®å­˜åœ¨å¤šä¸ªå¯å˜å¼•ç”¨ã€‚è¿™ä¸ªé™åˆ¶çš„å¥½å¤„æ˜¯ Rust å¯ä»¥åœ¨ç¼–è¯‘æ—¶å°±é¿å…æ•°æ®ç«äº‰ã€‚æ•°æ®ç«äº‰ï¼ˆdata raceï¼‰ç±»ä¼¼äºç«æ€æ¡ä»¶ï¼Œå®ƒå¯ç”±è¿™ä¸‰ä¸ªè¡Œä¸ºé€ æˆï¼š</p>
<ul>
<li>ä¸¤ä¸ªæˆ–æ›´å¤šæŒ‡é’ˆåŒæ—¶è®¿é—®åŒä¸€æ•°æ®ã€‚</li>
<li>è‡³å°‘æœ‰ä¸€ä¸ªæŒ‡é’ˆè¢«ç”¨æ¥å†™å…¥æ•°æ®ã€‚</li>
<li>æ²¡æœ‰åŒæ­¥æ•°æ®è®¿é—®çš„æœºåˆ¶ã€‚</li>
</ul>
<p>æƒ³æ‹¥æœ‰å¤šä¸ªå¯å˜å¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä½œç”¨åŸŸ</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let mut s = String::from("hello");

    {
        let r1 = &amp;mut s;
    } // r1 åœ¨è¿™é‡Œç¦»å¼€äº†ä½œç”¨åŸŸï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„å¼•ç”¨

    let r2 = &amp;mut s;
<span class="boring">}</span></code></pre></pre>
<p>æˆ‘ä»¬ ä¹Ÿ ä¸èƒ½åœ¨æ‹¥æœ‰ä¸å¯å˜å¼•ç”¨çš„åŒæ—¶æ‹¥æœ‰å¯å˜å¼•ç”¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let mut s = String::from("hello");

    let r1 = &amp;s; // æ²¡é—®é¢˜
    let r2 = &amp;s; // æ²¡é—®é¢˜
    let r3 = &amp;mut s; // å¤§é—®é¢˜

    println!("{}, {}, and {}", r1, r2, r3); // cannot borrow `s` as mutable because it is also borrowed as immutable
    // å¤šä¸ªä¸å¯å˜å¼•ç”¨æ˜¯å…è®¸çš„ï¼Œä½†ä¸€æ—¦æœ‰äº†å¯å˜å¼•ç”¨ï¼Œå°±ä¸èƒ½å†åˆ›å»ºå¯å˜å¼•ç”¨æˆ–è€…ä¸å¯å˜å¼•ç”¨
<span class="boring">}</span></code></pre></pre>
<p>æ³¨æ„ä¸€ä¸ªå¼•ç”¨çš„ä½œç”¨åŸŸä»å£°æ˜çš„åœ°æ–¹å¼€å§‹ä¸€ç›´æŒç»­åˆ°æœ€åä¸€æ¬¡ä½¿ç”¨ä¸ºæ­¢ã€‚ä¾‹å¦‚ï¼Œå› ä¸ºæœ€åä¸€æ¬¡ä½¿ç”¨ä¸å¯å˜å¼•ç”¨ï¼ˆprintln!)ï¼Œå‘ç”Ÿåœ¨å£°æ˜å¯å˜å¼•ç”¨ä¹‹å‰</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let mut s = String::from("hello");

    let r1 = &amp;s; // æ²¡é—®é¢˜
    let r2 = &amp;s; // æ²¡é—®é¢˜
    println!("{} and {}", r1, r2);
    // æ­¤ä½ç½®ä¹‹å r1 å’Œ r2 ä¸å†ä½¿ç”¨

    let r3 = &amp;mut s; // æ²¡é—®é¢˜
    println!("{}", r3);

<span class="boring">}</span></code></pre></pre>
<p>ä¸å¯å˜å¼•ç”¨ r1 å’Œ r2 çš„ä½œç”¨åŸŸåœ¨ println! æœ€åä¸€æ¬¡ä½¿ç”¨ä¹‹åç»“æŸï¼Œè¿™ä¹Ÿæ˜¯åˆ›å»ºå¯å˜å¼•ç”¨ r3 çš„åœ°æ–¹ã€‚å®ƒä»¬çš„ä½œç”¨åŸŸæ²¡æœ‰é‡å ï¼Œæ‰€ä»¥ä»£ç æ˜¯å¯ä»¥ç¼–è¯‘çš„ã€‚ç¼–è¯‘å™¨å¯ä»¥åœ¨ä½œç”¨åŸŸç»“æŸä¹‹å‰åˆ¤æ–­ä¸å†ä½¿ç”¨çš„å¼•ç”¨ã€‚</p>
<h2 id="æ‚¬å‚å¼•ç”¨dangling-references"><a class="header" href="#æ‚¬å‚å¼•ç”¨dangling-references">æ‚¬å‚å¼•ç”¨ï¼ˆDangling Referencesï¼‰</a></h2>
<p>å°è¯•åˆ›å»ºä¸€ä¸ªæ‚¬å‚å¼•ç”¨ï¼ŒRust ä¼šé€šè¿‡ä¸€ä¸ªç¼–è¯‘æ—¶é”™è¯¯æ¥é¿å…</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let reference_to_nothing = dangle();
}

fn dangle() -&gt; &amp;String {
    let s = String::from("hello");

    &amp;s
}
// missing lifetime specifier
// this function's return type contains a borrowed value, but there is no value for it to be borrowed from
// dangle æ–¹æ³•è¿”å›äº†ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼•ç”¨ï¼Œä½†æ˜¯è¿™ä¸ªå­—ç¬¦ä¸²åœ¨ dangleä½œç”¨åŸŸç»“æŸçš„æ—¶å€™è¢«é‡Šæ”¾ï¼Œå› æ­¤æŠ¥é”™</code></pre></pre>
<p>ä¸‹é¢æ˜¯å®é™…å‘ç”Ÿäº†ä»€ä¹ˆçš„è§£é‡Š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn dangle() -&gt; &amp;String { // dangle è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²çš„å¼•ç”¨

    let s = String::from("hello"); // s æ˜¯ä¸€ä¸ªæ–°å­—ç¬¦ä¸²

    &amp;s // è¿”å›å­—ç¬¦ä¸² s çš„å¼•ç”¨
} // è¿™é‡Œ s ç¦»å¼€ä½œç”¨åŸŸå¹¶è¢«ä¸¢å¼ƒã€‚å…¶å†…å­˜è¢«é‡Šæ”¾ã€‚
  // å±é™©ï¼
<span class="boring">}</span></code></pre></pre>
<p>è¿™é‡Œçš„è§£å†³æ–¹æ³•æ˜¯ç›´æ¥è¿”å› String</p>
<h2 id="æ€»ç»“"><a class="header" href="#æ€»ç»“">æ€»ç»“</a></h2>
<ul>
<li>åœ¨ä»»æ„ç»™å®šæ—¶é—´ï¼Œè¦ä¹ˆ åªèƒ½æœ‰ä¸€ä¸ªå¯å˜å¼•ç”¨ï¼Œè¦ä¹ˆ åªèƒ½æœ‰å¤šä¸ªä¸å¯å˜å¼•ç”¨ã€‚</li>
<li>å¼•ç”¨å¿…é¡»æ€»æ˜¯æœ‰æ•ˆçš„ã€‚</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="å¤åˆç±»å‹"><a class="header" href="#å¤åˆç±»å‹">å¤åˆç±»å‹</a></h1>
<h2 id="å­—ç¬¦ä¸²"><a class="header" href="#å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</a></h2>
<h3 id="åˆ‡ç‰‡slice"><a class="header" href="#åˆ‡ç‰‡slice">åˆ‡ç‰‡(slice)</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let s = String::from("hello world");

// åˆ›å»ºå­—ç¬¦ä¸²åˆ‡ç‰‡çš„è¯­æ³• æ–¹æ‹¬å·åŒ…æ‹¬çš„ä¸€ä¸ªåºåˆ—ï¼š[å¼€å§‹ç´¢å¼•..ç»ˆæ­¢ç´¢å¼•]
let hello = &amp;s[0..5];
let world = &amp;s[6..11];

// ç´¢å¼•ä»0å¼€å§‹ï¼Œä¸‹é¢ä¸¤ç§ç­‰æ•ˆ
let slice = &amp;s[0..2];
let slice = &amp;s[..2];

// æƒ³åŒ…å«æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œä¸‹é¢ä¸¤ç§ç­‰æ•ˆ
let len = s.len();

let slice = &amp;s[4..len];
let slice = &amp;s[4..];

// ä¹Ÿå¯ä»¥æˆªå–å®Œæ•´çš„åˆ‡ç‰‡
let slice = &amp;s[0..len];
let slice = &amp;s[..];

// ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²å°±æ˜¯å­—ç¬¦ä¸²åˆ‡ç‰‡ &amp;strç±»å‹ï¼Œè¯¥åˆ‡ç‰‡æŒ‡å‘äº†ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„æŸä¸ªç‚¹ï¼Œæ‰€ä»¥æ˜¯ä¸å¯å˜å¼•ç”¨
let s = "Hello, world!";
let s: &amp;str = "Hello, world!";


// åˆ‡ç‰‡æ˜¯å¯¹é›†åˆçš„éƒ¨åˆ†å¼•ç”¨ï¼Œå› æ­¤ä¸ä»…ä»…å­—ç¬¦ä¸²æœ‰åˆ‡ç‰‡ï¼Œå…¶å®ƒé›†åˆç±»å‹ä¹Ÿæœ‰ï¼Œä¾‹å¦‚æ•°ç»„
let a = [1, 2, 3, 4, 5];
let slice = &amp;a[1..3];
<span class="boring">}</span></code></pre></pre>
<h3 id="ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²"><a class="header" href="#ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²">ä»€ä¹ˆæ˜¯å­—ç¬¦ä¸²ï¼Ÿ</a></h3>
<p><strong>Rust ä¸­çš„å­—ç¬¦æ˜¯ Unicode ç±»å‹ï¼Œå› æ­¤æ¯ä¸ªå­—ç¬¦å æ® 4 ä¸ªå­—èŠ‚å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯åœ¨å­—ç¬¦ä¸²ä¸­ä¸ä¸€æ ·ï¼Œå­—ç¬¦ä¸²æ˜¯ UTF-8 ç¼–ç ï¼Œä¹Ÿå°±æ˜¯å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦æ‰€å çš„å­—èŠ‚æ•°æ˜¯å˜åŒ–çš„(1 - 4)ï¼Œè¿™æ ·æœ‰åŠ©äºå¤§å¹…é™ä½å­—ç¬¦ä¸²æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</strong></p>
<p>str ç±»å‹æ˜¯ç¡¬ç¼–ç è¿›å¯æ‰§è¡Œæ–‡ä»¶ï¼Œä¹Ÿæ— æ³•è¢«ä¿®æ”¹ï¼Œä½†æ˜¯ String åˆ™æ˜¯ä¸€ä¸ªå¯å¢é•¿ã€å¯æ”¹å˜ä¸”å…·æœ‰æ‰€æœ‰æƒçš„ UTF-8 ç¼–ç å­—ç¬¦ä¸²ï¼Œ<strong>å½“ Rust ç”¨æˆ·æåˆ°å­—ç¬¦ä¸²æ—¶ï¼Œå¾€å¾€æŒ‡çš„å°±æ˜¯ String ç±»å‹å’Œ &amp;str å­—ç¬¦ä¸²åˆ‡ç‰‡ç±»å‹ï¼Œè¿™ä¸¤ä¸ªç±»å‹éƒ½æ˜¯ UTF-8 ç¼–ç ã€‚</strong></p>
<h3 id="string-ä¸-str-çš„è½¬æ¢"><a class="header" href="#string-ä¸-str-çš„è½¬æ¢">String ä¸ &amp;str çš„è½¬æ¢</a></h3>
<pre><pre class="playground"><code class="language-rust">// &amp;str è½¬ String
String::from("hello,world")
"hello,world".to_string()

// String è½¬ &amp;str ç›´æ¥å–å¼•ç”¨
fn main() {
    let s = String::from("hello,world!");
    say_hello(&amp;s);
    say_hello(&amp;s[..]);
    say_hello(s.as_str());
}

fn say_hello(s: &amp;str) {
    println!("{}",s);
}</code></pre></pre>
<h3 id="å­—ç¬¦ä¸²ç´¢å¼•"><a class="header" href="#å­—ç¬¦ä¸²ç´¢å¼•">å­—ç¬¦ä¸²ç´¢å¼•</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// rust ä¸­ä½¿ç”¨ç´¢å¼•è®¿é—®å­—ç¬¦ä¸²ä¼šæŠ¥é”™
let s1 = String::from("hello");
let h = s1[0]; // `String` cannot be indexed by `{integer}`

// å­—ç¬¦ä¸²åº•å±‚æ˜¯å­—èŠ‚æ•°ç»„ï¼Œè€Œä¸”æ˜¯ utf-8ç¼–ç ï¼Œæ‰€ä»¥ä½¿ç”¨åˆ‡ç‰‡çš„å½¢å¼éå¸¸å±é™©ï¼Œæ— æ³•ä¿è¯ç´¢å¼•åŒºé—´æ­£å¥½åœ¨å­—ç¬¦çš„å­—èŠ‚è¾¹ç•Œï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å´©æºƒ
// å› ä¸ºç´¢å¼•çš„æ•°å­—æ˜¯å­—èŠ‚ä¸ºå•ä½ï¼Œä½†æ˜¯æ±‰å­—utf-8ç¼–ç çš„æ—¶å€™æ‰€å çš„å­—èŠ‚æ˜¯ä¸ä¸€å®šçš„ï¼Œæ‰€ä»¥æ— æ³•ä¿è¯ç´¢å¼•æ­£å¥½å–åˆ°äº†è¾¹ç•Œä½ç½®
let hello = "ä¸­å›½äºº";
let s = &amp;hello[0..2];
<span class="boring">}</span></code></pre></pre>
<h3 id="æ“ä½œå­—ç¬¦ä¸²"><a class="header" href="#æ“ä½œå­—ç¬¦ä¸²">æ“ä½œå­—ç¬¦ä¸²</a></h3>
<pre><pre class="playground"><code class="language-rust">// è¿½åŠ ï¼Œåœ¨åŸæœ‰çš„å­—ç¬¦ä¸²ä¸Šè¿½åŠ ï¼Œæ”¹å˜åŸå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å˜é‡å¿…é¡»ç”± mut å…³é”®å­—ä¿®é¥°
// push è¿½åŠ å•ä¸ªå­—ç¬¦
// push_str è¿½åŠ å­—ç¬¦ä¸²å­—é¢é‡
fn main() {
    let mut s = String::from("Hello ");

    s.push_str("rust");
    println!("è¿½åŠ å­—ç¬¦ä¸² push_str() -&gt; {}", s); // è¿½åŠ å­—ç¬¦ä¸² push_str() -&gt; Hello rust

    s.push('!');
    println!("è¿½åŠ å­—ç¬¦ push() -&gt; {}", s); // è¿½åŠ å­—ç¬¦ push() -&gt; Hello rust!
}

// æ’å…¥ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ’å…¥ä½ç½®ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ’å…¥çš„ç‰‡æ®µï¼Œå­—ç¬¦ä¸²å˜é‡å¿…é¡»ç”± mut å…³é”®å­—ä¿®é¥°
// insert æ’å…¥å•ä¸ªå­—ç¬¦
// insert_str æ’å…¥å­—ç¬¦ä¸²å­—é¢é‡
fn main() {
    let mut s = String::from("Hello rust!");
    s.insert(5, ',');
    println!("æ’å…¥å­—ç¬¦ insert() -&gt; {}", s); // æ’å…¥å­—ç¬¦ insert() -&gt; Hello, rust!
    s.insert_str(6, " I like");
    println!("æ’å…¥å­—ç¬¦ä¸² insert_str() -&gt; {}", s); // insert_str() -&gt; Hello, I like rust!
}

// æ›¿æ¢1 replace ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°çš„å­—ç¬¦ä¸²ï¼Œreplace æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²
// é€‚ç”¨äº String å’Œ &amp;str ç±»å‹
fn main() {
    let string_replace = String::from("I like rust. Learning rust is my favorite!");
    let new_string_replace = string_replace.replace("rust", "RUST");
    dbg!(new_string_replace); // new_string_replace = "I like RUST. Learning RUST is my favorite!"
}

// æ›¿æ¢2 replacen ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦è¢«æ›¿æ¢çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°çš„å­—ç¬¦ä¸²ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°åˆ™è¡¨ç¤ºæ›¿æ¢çš„ä¸ªæ•°ï¼Œreplacen æ–¹æ³•è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²
// é€‚ç”¨äº String å’Œ &amp;str ç±»å‹
fn main() {
    let string_replace = "I like rust. Learning rust is my favorite!";
    let new_string_replacen = string_replace.replacen("rust", "RUST", 1);
    dbg!(new_string_replacen); // new_string_replacen = "I like RUST. Learning rust is my favorite!"
}

// æ›¿æ¢3 replace_range ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦æ›¿æ¢å­—ç¬¦ä¸²çš„èŒƒå›´ï¼ˆRangeï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–°çš„å­—ç¬¦ä¸²ï¼Œreplace_range ç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œå˜é‡éœ€è¦ä½¿ç”¨ mut å…³é”®å­—ä¿®é¥°
// é€‚ç”¨äº String ç±»å‹
fn main() {
    let mut string_replace_range = String::from("I like rust!");
    string_replace_range.replace_range(7..8, "R");
    dbg!(string_replace_range); // string_replace_range = "I like Rust!"
}

// åˆ é™¤1 pop åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²çš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œè¿”å› Option ç±»å‹ï¼Œç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œéœ€è¦ mut å…³é”®å­—ä¿®é¥°
fn main() {
    let mut string_pop = String::from("rust pop ä¸­æ–‡!");
    let p1 = string_pop.pop();
    let p2 = string_pop.pop();
    dbg!(p1);
    dbg!(p2);
    dbg!(string_pop);
    /*
        p1 = Some(
        '!',
        )
        p2 = Some(
        'æ–‡',
        )
        string_pop = "rust pop ä¸­"
    */
}

// åˆ é™¤2 remove åˆ é™¤å¹¶è¿”å›å­—ç¬¦ä¸²ä¸­æŒ‡å®šä½ç½®çš„å­—ç¬¦ï¼Œç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œæ¥æ”¶ä¸€ä¸ªå‚æ•°è¢«åˆ é™¤çš„å­—ç¬¦çš„ç´¢å¼•
// remove() æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯
fn main() {
    let mut string_remove = String::from("æµ‹è¯•removeæ–¹æ³•");
    println!(
        "string_remove å  {} ä¸ªå­—èŠ‚",
        std::mem::size_of_val(string_remove.as_str())
    ); // string_remove å  18 ä¸ªå­—èŠ‚
    // åˆ é™¤ç¬¬ä¸€ä¸ªæ±‰å­—
    string_remove.remove(0);
    // ä¸‹é¢ä»£ç ä¼šå‘ç”Ÿé”™è¯¯
    // string_remove.remove(1);
    // ç›´æ¥åˆ é™¤ç¬¬äºŒä¸ªæ±‰å­—
    // string_remove.remove(3);
    dbg!(string_remove); // string_remove = "è¯•removeæ–¹æ³•"
}

// åˆ é™¤3 truncate åˆ é™¤å­—ç¬¦ä¸²ä¸­ä»æŒ‡å®šä½ç½®å¼€å§‹åˆ°ç»“å°¾çš„å…¨éƒ¨å­—ç¬¦ï¼Œç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œæ¥æ”¶ä¸€ä¸ªå‚æ•°è¢«åˆ é™¤çš„å­—ç¬¦ä¸²çš„èµ·å§‹ç´¢å¼•ï¼Œæ— è¿”å›å€¼
// truncate() æ–¹æ³•æ˜¯æŒ‰ç…§å­—èŠ‚æ¥å¤„ç†å­—ç¬¦ä¸²çš„ï¼Œå¦‚æœå‚æ•°æ‰€ç»™çš„ä½ç½®ä¸æ˜¯åˆæ³•çš„å­—ç¬¦è¾¹ç•Œï¼Œåˆ™ä¼šå‘ç”Ÿé”™è¯¯
fn main() {
    let mut string_truncate = String::from("æµ‹è¯•truncate");
    string_truncate.truncate(3);
    dbg!(string_truncate); // string_truncate = "æµ‹"
}

// åˆ é™¤4 clear æ¸…ç©ºå­—ç¬¦ä¸²ï¼Œç›´æ¥æ“ä½œåŸæ¥çš„å­—ç¬¦ä¸²ï¼Œåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œç›¸å½“äº truncate() æ–¹æ³•å‚æ•°ä¸º 0 çš„æ—¶å€™
fn main() {
    let mut string_clear = String::from("string clear");
    string_clear.clear();
    dbg!(string_clear); // string_clear = ""
}


// ä½¿ç”¨ + æˆ–è€… += è¿æ¥å­—ç¬¦ä¸²
// ä½¿ç”¨ + æˆ–è€… += è¿æ¥å­—ç¬¦ä¸²ï¼Œè¦æ±‚å³è¾¹çš„å‚æ•°å¿…é¡»ä¸ºå­—ç¬¦ä¸²çš„åˆ‡ç‰‡å¼•ç”¨ï¼ˆSliceï¼‰ç±»å‹
// + æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ä¸éœ€è¦ mut å…³é”®å­—ä¿®é¥°
fn main() {
    let string_append = String::from("hello ");
    let string_rust = String::from("rust");
    // &amp;string_rustä¼šè‡ªåŠ¨è§£å¼•ç”¨ä¸º&amp;str
    let result = string_append + &amp;string_rust;
    let mut result = result + "!"; // `result + "!"` ä¸­çš„ `result` æ˜¯ä¸å¯å˜çš„
    result += "!!!";

    println!("è¿æ¥å­—ç¬¦ä¸² + -&gt; {}", result); // è¿æ¥å­—ç¬¦ä¸² + -&gt; hello rust!!!!
}

// å½“è°ƒç”¨ + çš„æ“ä½œç¬¦æ—¶ï¼Œç›¸å½“äºè°ƒç”¨äº† std::string æ ‡å‡†åº“ä¸­çš„ add() æ–¹æ³•ï¼Œs1å˜é‡é€šè¿‡è°ƒç”¨ add() æ–¹æ³•åï¼Œs1æ‰€æœ‰æƒè¢«è½¬ç§»åˆ° add() æ–¹æ³•é‡Œé¢ï¼Œ add() æ–¹æ³•è°ƒç”¨åå°±è¢«é‡Šæ”¾
fn main() {
    let s1 = String::from("hello,");
    let s2 = String::from("world!");
    // åœ¨ä¸‹å¥ä¸­ï¼Œs1çš„æ‰€æœ‰æƒè¢«è½¬ç§»èµ°äº†ï¼Œå› æ­¤åé¢ä¸èƒ½å†ä½¿ç”¨s1
    let s3 = s1 + &amp;s2;
    assert_eq!(s3,"hello,world!");
    // ä¸‹é¢çš„è¯­å¥å¦‚æœå»æ‰æ³¨é‡Šï¼Œå°±ä¼šæŠ¥é”™
    // println!("{}",s1);
}

// ä½¿ç”¨ format! è¿æ¥å­—ç¬¦ä¸² é€‚ç”¨äº String å’Œ &amp;str
fn main() {
    let s1 = "hello";
    let s2 = String::from("rust");
    let s = format!("{} {}!", s1, s2);
    println!("{}", s); // hello rust!
}</code></pre></pre>
<h3 id="å­—ç¬¦ä¸²è½¬ä¹‰"><a class="header" href="#å­—ç¬¦ä¸²è½¬ä¹‰">å­—ç¬¦ä¸²è½¬ä¹‰</a></h3>
<p>å¯ä»¥é€šè¿‡è½¬ä¹‰çš„æ–¹å¼ \ è¾“å‡º ASCII å’Œ Unicode å­—ç¬¦</p>
<pre><pre class="playground"><code class="language-rust">fn main() {
    // é€šè¿‡ \ + å­—ç¬¦çš„åå…­è¿›åˆ¶è¡¨ç¤ºï¼Œè½¬ä¹‰è¾“å‡ºä¸€ä¸ªå­—ç¬¦
    let byte_escape = "I'm writing \x52\x75\x73\x74!";
    println!("What are you doing\x3F (\\x3F means ?) {}", byte_escape);

    // \u å¯ä»¥è¾“å‡ºä¸€ä¸ª unicode å­—ç¬¦
    let unicode_codepoint = "\u{211D}";
    let character_name = "\"DOUBLE-STRUCK CAPITAL R\"";

    println!(
        "Unicode character {} (U+211D) is called {}",
        unicode_codepoint, character_name
    );

    // æ¢è¡Œäº†ä¹Ÿä¼šä¿æŒä¹‹å‰çš„å­—ç¬¦ä¸²æ ¼å¼
    // ä½¿ç”¨\å¿½ç•¥æ¢è¡Œç¬¦
    let long_string = "String literals
                        can span multiple lines.
                        The linebreak and indentation here -&gt;\
                        &lt;- can be escaped too!";
    println!("{}", long_string);
}</code></pre></pre>
<pre><pre class="playground"><code class="language-rust">fn main() {
    println!("{}", "hello \\x52\\x75\\x73\\x74"); // hello \x52\x75\x73\x74
    let raw_str = r"Escapes don't work here: \x3F \u{211D}";
    println!("{}", raw_str); // Escapes don't work here: \x3F \u{211D}

    // å¦‚æœå­—ç¬¦ä¸²åŒ…å«åŒå¼•å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ  #
    let quotes = r#"And then I said: "There is no escape!""#;
    println!("{}", quotes); // And then I said: "There is no escape!"

    // å¦‚æœå­—ç¬¦ä¸²ä¸­åŒ…å« # å·ï¼Œå¯ä»¥åœ¨å¼€å¤´å’Œç»“å°¾åŠ å¤šä¸ª # å·ï¼Œæœ€å¤šåŠ 255ä¸ªï¼Œåªéœ€ä¿è¯ä¸å­—ç¬¦ä¸²ä¸­è¿ç»­ # å·çš„ä¸ªæ•°ä¸è¶…è¿‡å¼€å¤´å’Œç»“å°¾çš„ # å·çš„ä¸ªæ•°å³å¯
    let longer_delimiter = r###"A string with "# in it. And even "##!"###;
    println!("{}", longer_delimiter); // A string with "# in it. And even "##!
}</code></pre></pre>
<h3 id="æ“ä½œ-utf-8-å­—ç¬¦ä¸²"><a class="header" href="#æ“ä½œ-utf-8-å­—ç¬¦ä¸²">æ“ä½œ UTF-8 å­—ç¬¦ä¸²</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>for c in "ä¸­å›½äºº".chars() {
    println!("{}", c);
}

/*
ä¸­
å›½
äºº
*/

for b in "ä¸­å›½äºº".bytes() {
    println!("{}", b);
}

/*
228
184
173
229
155
189
228
186
186
*/
<span class="boring">}</span></code></pre></pre>
<h2 id="å…ƒç»„-1"><a class="header" href="#å…ƒç»„-1">å…ƒç»„</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of y is: {}", y);

    let five_hundred = tup.0;

    let six_point_four = tup.1;

    let one = tup.2;
}


fn main() {
    let s1 = String::from("hello");

    let (s2, len) = calculate_length(s1);

    println!("The length of '{}' is {}.", s2, len);
}

fn calculate_length(s: String) -&gt; (String, usize) {
    let length = s.len(); // len() è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦

    (s, length)
}</code></pre></pre>
<h2 id="ç»“æ„ä½“"><a class="header" href="#ç»“æ„ä½“">ç»“æ„ä½“</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// å®šä¹‰ç»“æ„ä½“
struct User {
    active: bool,
    username: String,
    email: String,
    sign_in_count: u64,
}

// åˆ›å»º User ç»“æ„ä½“å®ä¾‹
// åˆå§‹åŒ–å®ä¾‹æ—¶ï¼Œæ¯ä¸ªå­—æ®µéƒ½éœ€è¦è¿›è¡Œåˆå§‹åŒ–
// åˆå§‹åŒ–æ—¶çš„å­—æ®µé¡ºåºä¸éœ€è¦å’Œç»“æ„ä½“å®šä¹‰æ—¶çš„é¡ºåºä¸€è‡´
let mut user1 = User {
    email: String::from("someone@example.com"),
    username: String::from("someusername123"),
    active: true,
    sign_in_count: 1,
};

// é€šè¿‡ . æ“ä½œç¬¦è®¿é—®ç»“æ„ä½“å†…çš„å€¼ï¼Œä¹Ÿå¯ä»¥ä¿®æ”¹å€¼ã€‚ä¿®æ”¹å€¼éœ€è¦ mut
user1.email = String::from("anotheremail@example.com");

// å…ƒç»„ç»“æ„ä½“ ç»“æ„ä½“çš„å­—æ®µå¯ä»¥æ²¡æœ‰åç§°
struct Color(i32, i32, i32);
struct Point(i32, i32, i32);

let black = Color(0, 0, 0);
let origin = Point(0, 0, 0);

<span class="boring">}</span></code></pre></pre>
<h2 id="æšä¸¾"><a class="header" href="#æšä¸¾">æšä¸¾</a></h2>
<pre><pre class="playground"><code class="language-rust">#[derive(Debug)]
enum PokerSuit {
    Clubs,
    Spades,
    Diamonds,
    Hearts,
}

struct PokerCard {
    suit: PokerSuit,
    value: u8
}

fn main() {
   let c1 = PokerCard {
       suit: PokerSuit::Clubs,
       value: 1,
   };
   let c2 = PokerCard {
       suit: PokerSuit::Diamonds,
       value: 12,
   };
}

// ä¸‹é¢æ˜¯ç®€æ´çš„å†™æ³•ï¼Œå°†æ•°æ®å…³è”åˆ°æšä¸¾æˆå‘˜ä¸Š
enum PokerCard {
    Clubs(u8),
    Spades(u8),
    Diamonds(u8),
    Hearts(u8),
}

fn main() {
   let c1 = PokerCard::Spades(5);
   let c2 = PokerCard::Diamonds(13);
}

// ä¸‹é¢æ˜¯æ›´å¤æ‚çš„ä¾‹å­
/*
Quit æ²¡æœ‰ä»»ä½•å…³è”æ•°æ®
Move åŒ…å«ä¸€ä¸ªåŒ¿åç»“æ„ä½“
Write åŒ…å«ä¸€ä¸ª String å­—ç¬¦ä¸²
ChangeColor åŒ…å«ä¸‰ä¸ª i32
*/
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

fn main() {
    let m1 = Message::Quit;
    let m2 = Message::Move{x:1,y:1};
    let m3 = Message::ChangeColor(255,255,0);
}</code></pre></pre>
<h2 id="æ•°ç»„-1"><a class="header" href="#æ•°ç»„-1">æ•°ç»„</a></h2>
<pre><pre class="playground"><code class="language-rust">let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];

// i32 æ˜¯å…ƒç´ ç±»å‹ï¼Œåˆ†å·åé¢çš„æ•°å­— 5 æ˜¯æ•°ç»„é•¿åº¦
let a: [i32; 5] = [1, 2, 3, 4, 5];

// åŒ…å« 5 ä¸ªå…ƒç´ ï¼Œè¿™äº›å…ƒç´ çš„åˆå§‹åŒ–å€¼ä¸º 3
let a = [3; 5];


fn main() {
    let a = [9, 8, 7, 6, 5];

    let first = a[0]; // è·å–aæ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ 
    let second = a[1]; // è·å–ç¬¬äºŒä¸ªå…ƒç´ 
}</code></pre></pre>
<ul>
<li>æ•°ç»„è¶Šç•Œè®¿é—®ä¼šé€ æˆ panic å´©æºƒ</li>
</ul>
<pre><pre class="playground"><code class="language-rust">fn main() {
  // ç¼–è¯‘å™¨è‡ªåŠ¨æ¨å¯¼å‡ºoneçš„ç±»å‹
  let one             = [1, 2, 3];
  // æ˜¾å¼ç±»å‹æ ‡æ³¨
  let two: [u8; 3]    = [1, 2, 3];
  let blank1          = [0; 3];
  let blank2: [u8; 3] = [0; 3];

  // arraysæ˜¯ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ ç±»å‹æ˜¯[u8; 3]
  let arrays: [[u8; 3]; 4]  = [one, two, blank1, blank2];

  // å€Ÿç”¨arraysçš„å…ƒç´ ç”¨ä½œå¾ªç¯ä¸­
  for a in &amp;arrays {
    print!("{:?}: ", a);
    // å°†aå˜æˆä¸€ä¸ªè¿­ä»£å™¨ï¼Œç”¨äºå¾ªç¯
    // ä½ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨for n in a {}æ¥è¿›è¡Œå¾ªç¯
    for n in a.iter() {
      print!("\t{} + 10 = {}", n, n+10);
    }

    let mut sum = 0;
    // 0..a.len,æ˜¯ä¸€ä¸ª Rust çš„è¯­æ³•ç³–ï¼Œå…¶å®å°±ç­‰äºä¸€ä¸ªæ•°ç»„ï¼Œå…ƒç´ æ˜¯ä»0,1,2ä¸€ç›´å¢åŠ åˆ°åˆ°a.len-1
    for i in 0..a.len() {
      sum += a[i];
    }
    println!("\t({:?} = {})", a, sum);
  }
}</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æµç¨‹æ§åˆ¶"><a class="header" href="#æµç¨‹æ§åˆ¶">æµç¨‹æ§åˆ¶</a></h1>
<h2 id="if-else-if"><a class="header" href="#if-else-if">if else if</a></h2>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let condition = true;
    let number = if condition {
        5
    } else {
        6
    };

    println!("The value of number is: {}", number);
}

fn main() {
    let n = 6;

    if n % 4 == 0 {
        println!("number is divisible by 4");
    } else if n % 3 == 0 {
        println!("number is divisible by 3");
    } else if n % 2 == 0 {
        println!("number is divisible by 2");
    } else {
        println!("number is not divisible by 4, 3, or 2");
    }
}</code></pre></pre>
<h2 id="å¾ªç¯"><a class="header" href="#å¾ªç¯">å¾ªç¯</a></h2>
<h3 id="for"><a class="header" href="#for">for</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    for i in 1..=5 {
        println!("{}", i);
    }
}</code></pre></pre>
<div class="table-wrapper"><table><thead><tr><th>ä½¿ç”¨æ–¹æ³•</th><th>ç­‰ä»·ä½¿ç”¨æ–¹å¼</th><th>æ‰€æœ‰æƒ</th></tr></thead><tbody>
<tr><td><code>for item in collection</code></td><td><code>for item in IntoIterator::into_iter(collection)</code></td><td>è½¬ç§»æ‰€æœ‰æƒ</td></tr>
<tr><td><code>for item in &amp;collection</code></td><td><code>for item in collection.iter()</code></td><td>ä¸å¯å˜å€Ÿç”¨</td></tr>
<tr><td><code>for item in &amp;mut collection</code></td><td><code>for item in collection.iter_mut()</code></td><td>å¯å˜å€Ÿç”¨</td></tr>
</tbody></table>
</div>
<pre><pre class="playground"><code class="language-rust">// å¦‚æœæƒ³åœ¨å¾ªç¯ä¸­è·å–å…ƒç´ çš„ç´¢å¼•
fn main() {
    let a = [4, 3, 2, 1];
    // `.iter()` æ–¹æ³•æŠŠ `a` æ•°ç»„å˜æˆä¸€ä¸ªè¿­ä»£å™¨
    for (i, v) in a.iter().enumerate() {
        println!("ç¬¬{}ä¸ªå…ƒç´ æ˜¯{}", i + 1, v);
    }
}</code></pre></pre>
<p>ä¸¤ç§å¾ªç¯æ–¹å¼ä¼˜åŠ£å¯¹æ¯”</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ç¬¬ä¸€ç§
let collection = [1, 2, 3, 4, 5];
for i in 0..collection.len() {
  let item = collection[i];
  // ...
}

// ç¬¬äºŒç§
for item in collection {

}

<span class="boring">}</span></code></pre></pre>
<ul>
<li>
<p>æ€§èƒ½ï¼šç¬¬ä¸€ç§ä½¿ç”¨æ–¹å¼ä¸­ collection[index] çš„ç´¢å¼•è®¿é—®ï¼Œä¼šå› ä¸ºè¾¹ç•Œæ£€æŸ¥(Bounds Checking)å¯¼è‡´è¿è¡Œæ—¶çš„æ€§èƒ½æŸè€— â€”â€” Rust ä¼šæ£€æŸ¥å¹¶ç¡®è®¤ index æ˜¯å¦è½åœ¨é›†åˆå†…ï¼Œä½†æ˜¯ç¬¬äºŒç§ç›´æ¥è¿­ä»£çš„æ–¹å¼å°±ä¸ä¼šè§¦å‘è¿™ç§æ£€æŸ¥ï¼Œå› ä¸ºç¼–è¯‘å™¨ä¼šåœ¨ç¼–è¯‘æ—¶å°±å®Œæˆåˆ†æå¹¶è¯æ˜è¿™ç§è®¿é—®æ˜¯åˆæ³•çš„</p>
</li>
<li>
<p>å®‰å…¨ï¼šç¬¬ä¸€ç§æ–¹å¼é‡Œå¯¹ collection çš„ç´¢å¼•è®¿é—®æ˜¯éè¿ç»­çš„ï¼Œå­˜åœ¨ä¸€å®šå¯èƒ½æ€§åœ¨ä¸¤æ¬¡è®¿é—®ä¹‹é—´ï¼Œcollection å‘ç”Ÿäº†å˜åŒ–ï¼Œå¯¼è‡´è„æ•°æ®äº§ç”Ÿã€‚è€Œç¬¬äºŒç§ç›´æ¥è¿­ä»£çš„æ–¹å¼æ˜¯è¿ç»­è®¿é—®ï¼Œå› æ­¤ä¸å­˜åœ¨è¿™ç§é£é™©( ç”±äºæ‰€æœ‰æƒé™åˆ¶ï¼Œåœ¨è®¿é—®è¿‡ç¨‹ä¸­ï¼Œæ•°æ®å¹¶ä¸ä¼šå‘ç”Ÿå˜åŒ–)ã€‚</p>
</li>
</ul>
<h3 id="continue-break"><a class="header" href="#continue-break">continue break</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// continueè·³è¿‡å½“å‰å¾ªç¯
for i in 1..4 {
    if i == 2 {
        continue;
    }
    println!("{}", i);
}

// breakè·³å‡ºæ•´ä¸ªå¾ªç¯
for i in 1..4 {
    if i == 2 {
        break;
    }
    println!("{}", i);
}

<span class="boring">}</span></code></pre></pre>
<h3 id="while"><a class="header" href="#while">while</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
    let mut n = 0;

    while n &lt;= 5  {
        println!("{}!", n);

        n = n + 1;
    }

    println!("æˆ‘å‡ºæ¥äº†ï¼");
}

// while å¾ªç¯ å¦‚æœç´¢å¼•é•¿åº¦ä¸æ­£ç¡®ä¼šå¯¼è‡´ç¨‹åº panicã€‚è¿™ä¹Ÿä½¿ç¨‹åºæ›´æ…¢ï¼Œå› ä¸ºç¼–è¯‘å™¨å¢åŠ äº†è¿è¡Œæ—¶ä»£ç æ¥å¯¹æ¯æ¬¡å¾ªç¯çš„æ¯ä¸ªå…ƒç´ è¿›è¡Œæ¡ä»¶æ£€æŸ¥
fn main() {
    let a = [10, 20, 30, 40, 50];
    let mut index = 0;

    while index &lt; 5 {
        println!("the value is: {}", a[index]);

        index = index + 1;
    }
}

// for å¹¶ä¸ä¼šä½¿ç”¨ç´¢å¼•å»è®¿é—®æ•°ç»„ï¼Œå› æ­¤æ›´å®‰å…¨ä¹Ÿæ›´ç®€æ´ï¼ŒåŒæ—¶é¿å… è¿è¡Œæ—¶çš„è¾¹ç•Œæ£€æŸ¥ï¼Œæ€§èƒ½æ›´é«˜
fn main() {
    let a = [10, 20, 30, 40, 50];

    for element in a.iter() {
        println!("the value is: {}", element);
    }
}</code></pre></pre>
<h3 id="loop"><a class="header" href="#loop">loop</a></h3>
<pre><pre class="playground"><code class="language-rust">// break å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å¸¦ä¸€ä¸ªè¿”å›å€¼ï¼Œæœ‰äº›ç±»ä¼¼ return
// loop æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œå› æ­¤å¯ä»¥è¿”å›ä¸€ä¸ªå€¼
fn main() {
    let mut counter = 0;

    let result = loop {
        counter += 1;

        if counter == 10 {
            break counter * 2;
        }
    };

    println!("The result is {}", result);
}</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æ¨¡å¼åŒ¹é…"><a class="header" href="#æ¨¡å¼åŒ¹é…">æ¨¡å¼åŒ¹é…</a></h1>
<h2 id="match-if-let"><a class="header" href="#match-if-let">match if let</a></h2>
<pre><pre class="playground"><code class="language-rust">enum Direction {
    East,
    West,
    North,
    South,
}

fn main() {
    let dire = Direction::South;
    match dire {
        Direction::East =&gt; println!("East"),
        Direction::North | Direction::South =&gt; {
            println!("South or North");
        },
        _ =&gt; println!("West"),
    };
}</code></pre></pre>
<ul>
<li>match çš„åŒ¹é…å¿…é¡»è¦ç©·ä¸¾å‡ºæ‰€æœ‰å¯èƒ½ï¼Œå› æ­¤è¿™é‡Œç”¨ _ æ¥ä»£è¡¨æœªåˆ—å‡ºçš„æ‰€æœ‰å¯èƒ½æ€§</li>
<li>match çš„æ¯ä¸€ä¸ªåˆ†æ”¯éƒ½å¿…é¡»æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œä¸”æ‰€æœ‰åˆ†æ”¯çš„è¡¨è¾¾å¼æœ€ç»ˆè¿”å›å€¼çš„ç±»å‹å¿…é¡»ç›¸åŒ</li>
<li>X | Yï¼Œç±»ä¼¼é€»è¾‘è¿ç®—ç¬¦ æˆ–ï¼Œä»£è¡¨è¯¥åˆ†æ”¯å¯ä»¥åŒ¹é… X ä¹Ÿå¯ä»¥åŒ¹é… Yï¼Œåªè¦æ»¡è¶³ä¸€ä¸ªå³å¯</li>
</ul>
<pre><pre class="playground"><code class="language-rust">// æšä¸¾ä¸­çš„å€¼åœ¨ match ä¸­ä¹Ÿå¯ä»¥è¢«æ¨¡å¼åŒ¹é…è·å–åˆ°
enum Action {
    Say(String),
    MoveTo(i32, i32),
    ChangeColorRGB(u16, u16, u16),
}

fn main() {
    let actions = [
        Action::Say("Hello Rust".to_string()),
        Action::MoveTo(1,2),
        Action::ChangeColorRGB(255,255,0),
    ];
    for action in actions {
        match action {
            Action::Say(s) =&gt; {
                println!("{}", s);
            },
            Action::MoveTo(x, y) =&gt; {
                println!("point from (0, 0) move to ({}, {})", x, y);
            },
            Action::ChangeColorRGB(r, g, _) =&gt; {
                println!("change color into '(r:{}, g:{}, b:0)', 'b' has been ignored",
                    r, g,
                );
            }
        }
    }
}

// é™¤äº†_é€šé…ç¬¦ï¼Œç”¨ä¸€ä¸ªå˜é‡æ¥æ‰¿è½½å…¶ä»–æƒ…å†µä¹Ÿæ˜¯å¯ä»¥çš„
#[derive(Debug)]
enum Direction {
    East,
    West,
    North,
    South,
}

fn main() {
    let dire = Direction::South;
    match dire {
        Direction::East =&gt; println!("East"),
        other =&gt; println!("other direction: {:?}", other),
    };
}</code></pre></pre>
<h3 id="if-let"><a class="header" href="#if-let">if let</a></h3>
<p>å½“ä½ åªè¦åŒ¹é…ä¸€ä¸ªæ¡ä»¶ï¼Œä¸”å¿½ç•¥å…¶ä»–æ¡ä»¶æ—¶å°±ç”¨ if let ï¼Œå¦åˆ™éƒ½ç”¨ match</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>    let v = Some(3u8);
    match v {
        Some(3) =&gt; println!("three"),
        _ =&gt; (),
    }


if let Some(3) = v {
    println!("three");
}
<span class="boring">}</span></code></pre></pre>
<h3 id="matcheså®"><a class="header" href="#matcheså®">matches!å®</a></h3>
<pre><pre class="playground"><code class="language-rust">enum MyEnum {
    Foo,
    Bar
}

fn main() {
    let v = vec![MyEnum::Foo,MyEnum::Bar,MyEnum::Foo];

    // ä¸‹é¢è¿™å¥ä¼šæŠ¥é”™ï¼Œx æ— æ³•ä¸ MyEnum::Foo æ¯”è¾ƒ
    v.iter().filter(|x| x == MyEnum::Foo);

    v.iter().filter(|x| matches!(x, MyEnum::Foo));

}</code></pre></pre>
<h3 id="å˜é‡é®è”½"><a class="header" href="#å˜é‡é®è”½">å˜é‡é®è”½</a></h3>
<pre><pre class="playground"><code class="language-rust">fn main() {
   let age = Some(30);
   println!("åœ¨åŒ¹é…å‰ï¼Œageæ˜¯{:?}",age);
   if let Some(age) = age {
       println!("åŒ¹é…å‡ºæ¥çš„ageæ˜¯{}",age);
   }

   println!("åœ¨åŒ¹é…åï¼Œageæ˜¯{:?}",age);
}

fn main() {
   let age = Some(30);
   println!("åœ¨åŒ¹é…å‰ï¼Œageæ˜¯{:?}",age);
   match age {
       Some(age) =&gt;  println!("åŒ¹é…å‡ºæ¥çš„ageæ˜¯{}",age),
       _ =&gt; ()
   }
   println!("åœ¨åŒ¹é…åï¼Œageæ˜¯{:?}",age);
}</code></pre></pre>
<h2 id="è§£æ„-option"><a class="header" href="#è§£æ„-option">è§£æ„ Option</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// ä¸€ä¸ªå˜é‡è¦ä¹ˆæœ‰å€¼ï¼šSome(T), è¦ä¹ˆä¸ºç©ºï¼šNone
enum Option&lt;T&gt; {
    None,
    Some(T),
}

fn plus_one(x: Option&lt;i32&gt;) -&gt; Option&lt;i32&gt; {
    match x {
        None =&gt; None,
        Some(i) =&gt; Some(i + 1),
    }
}

let five = Some(5);
let six = plus_one(five);
let none = plus_one(None);
<span class="boring">}</span></code></pre></pre>
<h2 id="æ¨¡å¼é€‚ç”¨åœºæ™¯"><a class="header" href="#æ¨¡å¼é€‚ç”¨åœºæ™¯">æ¨¡å¼é€‚ç”¨åœºæ™¯</a></h2>
<pre><pre class="playground"><code class="language-rust">// match åŒ¹é…æ‰€æœ‰æ¨¡å¼
match VALUE {
    PATTERN =&gt; EXPRESSION,
    PATTERN =&gt; EXPRESSION,
    PATTERN =&gt; EXPRESSION,
}

// åŒ¹é…ä¸€ä¸ªæ¨¡å¼ï¼Œå¿½ç•¥å…¶ä»–æ¨¡å¼
if let PATTERN = SOME_VALUE {

}

// while let æ¡ä»¶å¾ªç¯ï¼Œåªè¦æ¨¡å¼åŒ¹é…å°±ä¸€ç›´è¿›è¡Œ while å¾ªç¯
let mut stack = Vec::new();

stack.push(1);
stack.push(2);
stack.push(3);

while let Some(top) = stack.pop() {
    println!("{}", top);
}

// è¿™é‡Œä½¿ç”¨ enumerate æ–¹æ³•äº§ç”Ÿä¸€ä¸ªè¿­ä»£å™¨ï¼Œè¯¥è¿­ä»£å™¨æ¯æ¬¡è¿­ä»£ä¼šè¿”å›ä¸€ä¸ª (ç´¢å¼•ï¼Œå€¼) å½¢å¼çš„å…ƒç»„ï¼Œç„¶åç”¨ (index,value) æ¥åŒ¹é…
let v = vec!['a', 'b', 'c'];

for (index, value) in v.iter().enumerate() {
    println!("{} is at index {}", value, index);
}

// å°†åŒ¹é…çš„å€¼ç»‘å®šåˆ°å˜é‡ x ä¸Šï¼Œå˜é‡åä¹Ÿæ˜¯ä¸€ç§æ¨¡å¼
let PATTERN = EXPRESSION;
let (x, y, z) = (1, 2, 3);

// å‡½æ•°å‚æ•°ä¹Ÿæ˜¯ä¸€ç§æ¨¡å¼
fn print_coordinates(&amp;(x, y): &amp;(i32, i32)) {
    println!("Current location: ({}, {})", x, y);
}

fn main() {
    let point = (3, 5);
    print_coordinates(&amp;point);
}

// ä»¥ä¸‹ä»£ç ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™
// å› ä¸ºå³è¾¹çš„å€¼å¯èƒ½ä¸ä¸º Someï¼Œè€Œæ˜¯ Noneï¼Œè¿™ç§æ—¶å€™å°±ä¸èƒ½è¿›è¡ŒåŒ¹é…ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢çš„ä»£ç é—æ¼äº† None çš„åŒ¹é…ã€‚
// ç±»ä¼¼ let , forå’Œmatch éƒ½å¿…é¡»è¦æ±‚å®Œå…¨è¦†ç›–åŒ¹é…ï¼Œæ‰èƒ½é€šè¿‡ç¼–è¯‘( ä¸å¯é©³æ¨¡å¼åŒ¹é… )ã€‚
let Some(x) = some_option_value;

// if let å…è®¸åŒ¹é…ä¸€ç§æ¨¡å¼ï¼Œè€Œå¿½ç•¥å…¶ä½™çš„æ¨¡å¼( å¯é©³æ¨¡å¼åŒ¹é… )ã€‚
if let Some(x) = some_option_value {
    println!("{}", x);
}


// ä½¿ç”¨ let-else åŒ¹é…ï¼Œå³å¯ä½¿ let å˜ä¸ºå¯é©³æ¨¡å¼ã€‚å®ƒå¯ä»¥ä½¿ç”¨ else åˆ†æ”¯æ¥å¤„ç†æ¨¡å¼ä¸åŒ¹é…çš„æƒ…å†µ
// ä½†æ˜¯ else åˆ†æ”¯ä¸­å¿…é¡»ç”¨å‘æ•£çš„ä»£ç å—å¤„ç†ï¼ˆä¾‹å¦‚ï¼šbreakã€returnã€panicï¼‰ã€‚
use std::str::FromStr;

fn get_count_item(s: &amp;str) -&gt; (u64, &amp;str) {
    let mut it = s.split(' ');
    let (Some(count_str), Some(item)) = (it.next(), it.next()) else {
        panic!("Can't segment count item pair: '{s}'");
    };
    let Ok(count) = u64::from_str(count_str) else {
        panic!("Can't parse integer: '{count_str}'");
    };
    // error: `else` clause of `let...else` does not diverge
    // let Ok(count) = u64::from_str(count_str) else { 0 };
    (count, item)
}

fn main() {
    assert_eq!(get_count_item("3 chairs"), (3, "chairs"));
}


// ä¸ match å’Œ if let ç›¸æ¯”ï¼Œlet-else çš„ä¸€ä¸ªæ˜¾è‘—ç‰¹ç‚¹åœ¨äºå…¶è§£åŒ…æˆåŠŸæ—¶æ‰€åˆ›å»ºçš„å˜é‡å…·æœ‰æ›´å¹¿çš„ä½œç”¨åŸŸã€‚
// åœ¨ let-else è¯­å¥ä¸­ï¼ŒæˆåŠŸåŒ¹é…åçš„å˜é‡ä¸å†ä»…é™äºç‰¹å®šåˆ†æ”¯å†…ä½¿ç”¨
// if let
if let Some(x) = some_option_value {
    println!("{}", x);
}

// let-else
let Some(x) = some_option_value else { return; }
println!("{}", x);
</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æ–¹æ³•"><a class="header" href="#æ–¹æ³•">æ–¹æ³•</a></h1>
<h2 id="å®šä¹‰æ–¹æ³•"><a class="header" href="#å®šä¹‰æ–¹æ³•">å®šä¹‰æ–¹æ³•</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Circle {
    x: f64,
    y: f64,
    radius: f64,
}

impl Circle {
    // newæ˜¯Circleçš„å…³è”å‡½æ•°ï¼Œå› ä¸ºå®ƒçš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸æ˜¯selfï¼Œä¸”newå¹¶ä¸æ˜¯å…³é”®å­—
    // è¿™ç§æ–¹æ³•å¾€å¾€ç”¨äºåˆå§‹åŒ–å½“å‰ç»“æ„ä½“çš„å®ä¾‹
    fn new(x: f64, y: f64, radius: f64) -&gt; Circle {
        Circle {
            x: x,
            y: y,
            radius: radius,
        }
    }

    // Circleçš„æ–¹æ³•ï¼Œ&amp;selfè¡¨ç¤ºå€Ÿç”¨å½“å‰çš„Circleç»“æ„ä½“
    fn area(&amp;self) -&gt; f64 {
        std::f64::consts::PI * (self.radius * self.radius)
    }
}

<span class="boring">}</span></code></pre></pre>
<p>impl æ˜¯å®ç° implementation çš„ç¼©å†™</p>
<pre><pre class="playground"><code class="language-rust">#[derive(Debug)]
struct Rectangle {
    width: u32,
    height: u32,
}

impl Rectangle {
    fn area(&amp;self) -&gt; u32 {
        self.width * self.height
    }
}

fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };

    println!(
        "The area of the rectangle is {} square pixels.",
        rect1.area()
    );
}</code></pre></pre>
<p>åœ¨ area çš„ç­¾åä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ &amp;self æ›¿ä»£ rectangle: &amp;Rectangleï¼Œ&amp;self å…¶å®æ˜¯ self: &amp;Self çš„ç®€å†™ï¼ˆæ³¨æ„å¤§å°å†™ï¼‰ã€‚åœ¨ä¸€ä¸ª impl å—å†…ï¼ŒSelf æŒ‡ä»£è¢«å®ç°æ–¹æ³•çš„ç»“æ„ä½“ç±»å‹ï¼Œself æŒ‡ä»£æ­¤ç±»å‹çš„å®ä¾‹ï¼Œæ¢å¥è¯è¯´ï¼Œself æŒ‡ä»£çš„æ˜¯ Rectangle ç»“æ„ä½“å®ä¾‹ã€‚</p>
<ul>
<li>self è¡¨ç¤º Rectangle çš„æ‰€æœ‰æƒè½¬ç§»åˆ°è¯¥æ–¹æ³•ä¸­ï¼Œè¿™ç§å½¢å¼ç”¨çš„è¾ƒå°‘</li>
<li>&amp;self è¡¨ç¤ºè¯¥æ–¹æ³•å¯¹ Rectangle çš„ä¸å¯å˜å€Ÿç”¨</li>
<li>&amp;mut self è¡¨ç¤ºå¯å˜å€Ÿç”¨</li>
</ul>
<p>ç®€å•æ€»ç»“ä¸‹ï¼Œä½¿ç”¨æ–¹æ³•ä»£æ›¿å‡½æ•°æœ‰ä»¥ä¸‹å¥½å¤„ï¼š</p>
<ul>
<li>ä¸ç”¨åœ¨å‡½æ•°ç­¾åä¸­é‡å¤ä¹¦å†™ self å¯¹åº”çš„ç±»å‹</li>
<li>ä»£ç çš„ç»„ç»‡æ€§å’Œå†…èšæ€§æ›´å¼ºï¼Œå¯¹äºä»£ç ç»´æŠ¤å’Œé˜…è¯»æ¥è¯´ï¼Œå¥½å¤„å·¨å¤§</li>
</ul>
<h2 id="å¤šä¸ªå‚æ•°"><a class="header" href="#å¤šä¸ªå‚æ•°">å¤šä¸ªå‚æ•°</a></h2>
<pre><pre class="playground"><code class="language-rust">impl Rectangle {
    fn area(&amp;self) -&gt; u32 {
        self.width * self.height
    }

    fn can_hold(&amp;self, other: &amp;Rectangle) -&gt; bool {
        self.width &gt; other.width &amp;&amp; self.height &gt; other.height
    }
}

fn main() {
    let rect1 = Rectangle { width: 30, height: 50 };
    let rect2 = Rectangle { width: 10, height: 40 };
    let rect3 = Rectangle { width: 60, height: 45 };

    println!("Can rect1 hold rect2? {}", rect1.can_hold(&amp;rect2));
    println!("Can rect1 hold rect3? {}", rect1.can_hold(&amp;rect3));
}</code></pre></pre>
<h2 id="å…³è”å‡½æ•°"><a class="header" href="#å…³è”å‡½æ•°">å…³è”å‡½æ•°</a></h2>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Rectangle {
    fn new(w: u32, h: u32) -&gt; Rectangle {
        Rectangle { width: w, height: h }
    }
}

let sq = Rectangle::new(3, 3);
<span class="boring">}</span></code></pre></pre>
<p>å®šä¹‰åœ¨ impl ä¸­ä¸”æ²¡æœ‰ self çš„å‡½æ•°è¢«ç§°ä¹‹ä¸ºå…³è”å‡½æ•°ï¼š å› ä¸ºå®ƒæ²¡æœ‰ selfï¼Œä¸èƒ½ç”¨ f.read() çš„å½¢å¼è°ƒç”¨ï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªå‡½æ•°è€Œä¸æ˜¯æ–¹æ³•ï¼Œå®ƒåˆåœ¨ impl ä¸­ï¼Œä¸ç»“æ„ä½“ç´§å¯†å…³è”ï¼Œå› æ­¤ç§°ä¸ºå…³è”å‡½æ•°ã€‚</p>
<h2 id="ä¸ºæšä¸¾å®ç°æ–¹æ³•"><a class="header" href="#ä¸ºæšä¸¾å®ç°æ–¹æ³•">ä¸ºæšä¸¾å®ç°æ–¹æ³•</a></h2>
<pre><pre class="playground"><code class="language-rust">#![allow(unused)]
enum Message {
    Quit,
    Move { x: i32, y: i32 },
    Write(String),
    ChangeColor(i32, i32, i32),
}

impl Message {
    fn call(&amp;self) {
        // åœ¨è¿™é‡Œå®šä¹‰æ–¹æ³•ä½“
    }
}

fn main() {
    let m = Message::Write(String::from("hello"));
    m.call();
}</code></pre></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="æ³›å‹å’Œç‰¹å¾"><a class="header" href="#æ³›å‹å’Œç‰¹å¾">æ³›å‹å’Œç‰¹å¾</a></h1>
<h2 id="æ³›å‹"><a class="header" href="#æ³›å‹">æ³›å‹</a></h2>
<p>æˆ‘ä»¬åœ¨ç¼–ç¨‹ä¸­ï¼Œç»å¸¸æœ‰è¿™æ ·çš„éœ€æ±‚ï¼šç”¨åŒä¸€åŠŸèƒ½çš„å‡½æ•°å¤„ç†ä¸åŒç±»å‹çš„æ•°æ®ï¼Œä¾‹å¦‚ä¸¤ä¸ªæ•°çš„åŠ æ³•ï¼Œæ— è®ºæ˜¯æ•´æ•°è¿˜æ˜¯æµ®ç‚¹æ•°ï¼Œç”šè‡³æ˜¯è‡ªå®šä¹‰ç±»å‹ï¼Œéƒ½èƒ½è¿›è¡Œæ”¯æŒã€‚åœ¨ä¸æ”¯æŒæ³›å‹çš„ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œé€šå¸¸éœ€è¦ä¸ºæ¯ä¸€ç§ç±»å‹ç¼–å†™ä¸€ä¸ªå‡½æ•°</p>
<p>å®é™…ä¸Šï¼Œæ³›å‹å°±æ˜¯ä¸€ç§å¤šæ€ã€‚æ³›å‹ä¸»è¦ç›®çš„æ˜¯ä¸ºç¨‹åºå‘˜æä¾›ç¼–ç¨‹çš„ä¾¿åˆ©ï¼Œå‡å°‘ä»£ç çš„è‡ƒè‚¿ï¼ŒåŒæ—¶å¯ä»¥æå¤§åœ°ä¸°å¯Œè¯­è¨€æœ¬èº«çš„è¡¨è¾¾èƒ½åŠ›ã€‚æƒ³æƒ³ï¼Œä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä»£æ›¿å‡ åä¸ªï¼Œç”šè‡³æ•°ç™¾ä¸ªå‡½æ•°ï¼Œæ˜¯ä¸€ä»¶å¤šä¹ˆè®©äººå…´å¥‹çš„äº‹æƒ…ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn add&lt;T&gt;(a:T, b:T) -&gt; T {
    a + b
}

fn main() {
    println!("add i8: {}", add(2i8, 3i8));
    println!("add i32: {}", add(20, 30));
    println!("add f64: {}", add(1.23, 1.23));
}</code></pre></pre>
<h3 id="è¯¦è§£"><a class="header" href="#è¯¦è§£">è¯¦è§£</a></h3>
<p>ä½¿ç”¨æ³›å‹å‚æ•°ï¼Œæœ‰ä¸€ä¸ªå…ˆå†³æ¡ä»¶ï¼Œå¿…éœ€åœ¨ä½¿ç”¨å‰å¯¹å…¶è¿›è¡Œå£°æ˜ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn largest&lt;T&gt;(list: &amp;[T]) -&gt; T {
<span class="boring">}</span></code></pre></pre>
<p>æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£è¿™ä¸ªå‡½æ•°å®šä¹‰ï¼šå‡½æ•° largest æœ‰æ³›å‹ç±»å‹ Tï¼Œå®ƒæœ‰ä¸ªå‚æ•° listï¼Œå…¶ç±»å‹æ˜¯å…ƒç´ ä¸º T çš„æ•°ç»„åˆ‡ç‰‡ï¼Œæœ€åï¼Œè¯¥å‡½æ•°è¿”å›å€¼çš„ç±»å‹ä¹Ÿæ˜¯ Tã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªé”™è¯¯çš„æ³›å‹å‡½æ•°çš„å®ç°ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn largest&lt;T&gt;(list: &amp;[T]) -&gt; T {
    let mut largest = list[0];

    for &amp;item in list.iter() {
        if item &gt; largest {
            largest = item;
        }
    }

    largest
}

fn main() {
    let number_list = vec![34, 50, 25, 100, 65];

    let result = largest(&amp;number_list);
    println!("The largest number is {}", result);

    let char_list = vec!['y', 'm', 'a', 'q'];

    let result = largest(&amp;char_list);
    println!("The largest char is {}", result);
}


/*
error[E0369]: binary operation `&gt;` cannot be applied to type `T` // `&gt;`æ“ä½œç¬¦ä¸èƒ½ç”¨äºç±»å‹`T`
 --&gt; src/main.rs:5:17
  |
5 |         if item &gt; largest {
  |            ---- ^ ------- T
  |            |
  |            T
  |
help: consider restricting type parameter `T` // è€ƒè™‘å¯¹Tè¿›è¡Œç±»å‹ä¸Šçš„é™åˆ¶ :
  |
1 | fn largest&lt;T: std::cmp::PartialOrd&gt;(list: &amp;[T]) -&gt; T {
  |             ++++++++++++++++++++++
*/</code></pre></pre>
<p>å› ä¸º T å¯ä»¥æ˜¯ä»»ä½•ç±»å‹ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„ç±»å‹éƒ½èƒ½è¿›è¡Œæ¯”è¾ƒï¼Œå› æ­¤ä¸Šé¢çš„é”™è¯¯ä¸­ï¼Œç¼–è¯‘å™¨å»ºè®®æˆ‘ä»¬ç»™ T æ·»åŠ ä¸€ä¸ªç±»å‹é™åˆ¶ï¼šä½¿ç”¨ std::cmp::PartialOrd ç‰¹å¾ï¼ˆTraitï¼‰å¯¹ T è¿›è¡Œé™åˆ¶</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>fn largest&lt;T: std::cmp::PartialOrd&gt;(list: &amp;[T]) -&gt; T {
    let mut largest = list[0];

    for &amp;item in list.iter() {
        if item &gt; largest {
            largest = item;
        }
    }

    largest
}
<span class="boring">}</span></code></pre></pre>
<h3 id="æ˜¾å¼åœ°æŒ‡å®šæ³›å‹çš„ç±»å‹å‚æ•°"><a class="header" href="#æ˜¾å¼åœ°æŒ‡å®šæ³›å‹çš„ç±»å‹å‚æ•°">æ˜¾å¼åœ°æŒ‡å®šæ³›å‹çš„ç±»å‹å‚æ•°</a></h3>
<pre><pre class="playground"><code class="language-rust">use std::fmt::Display;

fn create_and_print&lt;T&gt;() where T: From&lt;i32&gt; + Display {
    let a: T = 100.into(); // åˆ›å»ºäº†ç±»å‹ä¸º T çš„å˜é‡ aï¼Œå®ƒçš„åˆå§‹å€¼ç”± 100 è½¬æ¢è€Œæ¥
    println!("a is: {}", a);
}

fn main() {
    create_and_print();
}

/*
error[E0283]: type annotations needed // éœ€è¦æ ‡æ˜ç±»å‹
 --&gt; src/main.rs:9:5
  |
9 |     create_and_print();
  |     ^^^^^^^^^^^^^^^^ cannot infer type of the type parameter `T` declared on the function `create_and_print` // æ— æ³•æ¨æ–­å‡½æ•° `create_and_print` çš„ç±»å‹å‚æ•° `T` çš„ç±»å‹
  |
  = note: multiple `impl`s satisfying `_: From&lt;i32&gt;` found in the `core` crate:
          - impl From&lt;i32&gt; for AtomicI32;
          - impl From&lt;i32&gt; for f64;
          - impl From&lt;i32&gt; for i128;
          - impl From&lt;i32&gt; for i64;
note: required by a bound in `create_and_print`
 --&gt; src/main.rs:3:35
  |
3 | fn create_and_print&lt;T&gt;() where T: From&lt;i32&gt; + Display {
  |                                   ^^^^^^^^^ required by this bound in `create_and_print`
help: consider specifying the generic argument // å°è¯•æŒ‡å®šæ³›å‹å‚æ•°
  |
9 |     create_and_print::&lt;T&gt;();
  |                     +++++

*/</code></pre></pre>
<p>æŠ¥é”™é‡Œè¯´å¾—å¾ˆæ¸…æ¥šï¼Œç¼–è¯‘å™¨ä¸çŸ¥é“ T åˆ°åº•åº”è¯¥æ˜¯ä»€ä¹ˆç±»å‹ã€‚ä¸è¿‡å¥½å¿ƒçš„ç¼–è¯‘å™¨å·²ç»å¸®æˆ‘ä»¬åˆ—å‡ºäº†æ»¡è¶³æ¡ä»¶çš„ç±»å‹ï¼Œç„¶åå‘Šè¯‰æˆ‘ä»¬è§£å†³æ–¹æ³•ï¼šæ˜¾å¼æŒ‡å®šç±»å‹ï¼šcreate_and_print::<T>()</p>
<pre><pre class="playground"><code class="language-rust">use std::fmt::Display;

fn create_and_print&lt;T&gt;() where T: From&lt;i32&gt; + Display {
    let a: T = 100.into(); // åˆ›å»ºäº†ç±»å‹ä¸º T çš„å˜é‡ aï¼Œå®ƒçš„åˆå§‹å€¼ç”± 100 è½¬æ¢è€Œæ¥
    println!("a is: {}", a);
}

fn main() {
    create_and_print::&lt;i64&gt;(); // æ˜¾å¼æŒ‡å®šTç±»å‹
}</code></pre></pre>
<h3 id="ç»“æ„ä½“ä¸­ä½¿ç”¨æ³›å‹"><a class="header" href="#ç»“æ„ä½“ä¸­ä½¿ç”¨æ³›å‹">ç»“æ„ä½“ä¸­ä½¿ç”¨æ³›å‹</a></h3>
<pre><pre class="playground"><code class="language-rust">struct Point&lt;T,U&gt; {
    x: T,
    y: U,
}
fn main() {
    let p = Point{x: 1, y :1.1};
}</code></pre></pre>
<h3 id="æšä¸¾ä¸­ä½¿ç”¨æ³›å‹"><a class="header" href="#æšä¸¾ä¸­ä½¿ç”¨æ³›å‹">æšä¸¾ä¸­ä½¿ç”¨æ³›å‹</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// Option&lt;T&gt; æ˜¯ä¸€ä¸ªæ‹¥æœ‰æ³›å‹ T çš„æšä¸¾ç±»å‹ï¼Œå®ƒç¬¬ä¸€ä¸ªæˆå‘˜æ˜¯ Some(T)ï¼Œå­˜æ”¾äº†ä¸€ä¸ªç±»å‹ä¸º T çš„å€¼
enum Option&lt;T&gt; {
    Some(T),
    None,
}

// å¦‚æœå‡½æ•°æ­£å¸¸è¿è¡Œï¼Œåˆ™æœ€åè¿”å›ä¸€ä¸ª Ok(T)ï¼ŒT æ˜¯å‡½æ•°å…·ä½“çš„è¿”å›å€¼ç±»å‹ï¼Œå¦‚æœå‡½æ•°å¼‚å¸¸è¿è¡Œï¼Œåˆ™è¿”å›ä¸€ä¸ª Err(E)ï¼ŒE æ˜¯é”™è¯¯ç±»å‹
enum Result&lt;T, E&gt; {
    Ok(T),
    Err(E),
}

<span class="boring">}</span></code></pre></pre>
<h3 id="æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹"><a class="header" href="#æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹">æ–¹æ³•ä¸­ä½¿ç”¨æ³›å‹</a></h3>
<pre><pre class="playground"><code class="language-rust">struct Point&lt;T&gt; {
    x: T,
    y: T,
}

impl&lt;T&gt; Point&lt;T&gt; {
    fn x(&amp;self) -&gt; &amp;T {
        &amp;self.x
    }
}

fn main() {
    let p = Point { x: 5, y: 10 };

    println!("p.x = {}", p.x());
}</code></pre></pre>
<p>é™¤äº†ç»“æ„ä½“ä¸­çš„æ³›å‹å‚æ•°ï¼Œæˆ‘ä»¬è¿˜èƒ½åœ¨è¯¥ç»“æ„ä½“çš„æ–¹æ³•ä¸­å®šä¹‰é¢å¤–çš„æ³›å‹å‚æ•°ï¼Œå°±è·Ÿæ³›å‹å‡½æ•°ä¸€æ ·ï¼š</p>
<pre><pre class="playground"><code class="language-rust">struct Point&lt;T, U&gt; {
    x: T,
    y: U,
}

impl&lt;T, U&gt; Point&lt;T, U&gt; {
    fn mixup&lt;V, W&gt;(self, other: Point&lt;V, W&gt;) -&gt; Point&lt;T, W&gt; {
        Point {
            x: self.x,
            y: other.y,
        }
    }
}

fn main() {
    let p1 = Point { x: 5, y: 10.4 };
    let p2 = Point { x: "Hello", y: 'c'};

    let p3 = p1.mixup(p2);

    println!("p3.x = {}, p3.y = {}", p3.x, p3.y);
}</code></pre></pre>
<p>è¿™ä¸ªä¾‹å­ä¸­ï¼ŒT,U æ˜¯å®šä¹‰åœ¨ç»“æ„ä½“ Point ä¸Šçš„æ³›å‹å‚æ•°ï¼ŒV,W æ˜¯å•ç‹¬å®šä¹‰åœ¨æ–¹æ³• mixup ä¸Šçš„æ³›å‹å‚æ•°ï¼Œå®ƒä»¬å¹¶ä¸å†²çªï¼Œè¯´ç™½äº†ï¼Œä½ å¯ä»¥ç†è§£ä¸ºï¼Œä¸€ä¸ªæ˜¯ç»“æ„ä½“æ³›å‹ï¼Œä¸€ä¸ªæ˜¯å‡½æ•°æ³›å‹ã€‚</p>
<p>å¯¹äº Point<T> ç±»å‹ï¼Œä½ ä¸ä»…èƒ½å®šä¹‰åŸºäº T çš„æ–¹æ³•ï¼Œè¿˜èƒ½é’ˆå¯¹ç‰¹å®šçš„å…·ä½“ç±»å‹ï¼Œè¿›è¡Œæ–¹æ³•å®šä¹‰ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Point&lt;f32&gt; {
    fn distance_from_origin(&amp;self) -&gt; f32 {
        (self.x.powi(2) + self.y.powi(2)).sqrt()
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="const-æ³›å‹rust-151-ç‰ˆæœ¬å¼•å…¥çš„é‡è¦ç‰¹æ€§"><a class="header" href="#const-æ³›å‹rust-151-ç‰ˆæœ¬å¼•å…¥çš„é‡è¦ç‰¹æ€§">const æ³›å‹ï¼ˆRust 1.51 ç‰ˆæœ¬å¼•å…¥çš„é‡è¦ç‰¹æ€§ï¼‰</a></h3>
<pre><pre class="playground"><code class="language-rust">fn display_array(arr: [i32; 3]) {
    println!("{:?}", arr);
}
fn main() {
    let arr: [i32; 3] = [1, 2, 3];
    display_array(arr);

    let arr: [i32; 2] = [1, 2];
    display_array(arr);
}

error[E0308]: mismatched types // ç±»å‹ä¸åŒ¹é…
  --&gt; src/main.rs:10:19
   |
10 |     display_array(arr);
   |                   ^^^ expected an array with a fixed size of 3 elements, found one with 2 elements
                          // æœŸæœ›ä¸€ä¸ªé•¿åº¦ä¸º3çš„æ•°ç»„ï¼Œå´å‘ç°ä¸€ä¸ªé•¿åº¦ä¸º2çš„
</code></pre></pre>
<p>[i32; 3] å’Œ [i32; 2] ç¡®å®æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸åŒçš„ç±»å‹ï¼Œå› æ­¤æ— æ³•ç”¨åŒä¸€ä¸ªå‡½æ•°è°ƒç”¨ã€‚</p>
<p>åªè¦ä½¿ç”¨æ•°ç»„åˆ‡ç‰‡ï¼Œç„¶åä¼ å…¥ arr çš„ä¸å¯å˜å¼•ç”¨å³å¯ã€‚</p>
<p>æ¥ç€ï¼Œå°† i32 æ”¹æˆæ‰€æœ‰ç±»å‹çš„æ•°ç»„ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn display_array&lt;T: std::fmt::Debug&gt;(arr: &amp;[T]) {
    println!("{:?}", arr);
}
fn main() {
    let arr: [i32; 3] = [1, 2, 3];
    display_array(&amp;arr);

    let arr: [i32; 2] = [1, 2];
    display_array(&amp;arr);
}</code></pre></pre>
<p>å”¯ä¸€è¦æ³¨æ„çš„æ˜¯éœ€è¦å¯¹ T åŠ ä¸€ä¸ªé™åˆ¶ std::fmt::Debugï¼Œè¯¥é™åˆ¶è¡¨æ˜ T å¯ä»¥ç”¨åœ¨ println!("{:?}", arr) ä¸­ï¼Œå› ä¸º {:?} å½¢å¼çš„æ ¼å¼åŒ–è¾“å‡ºéœ€è¦ arr å®ç°è¯¥ç‰¹å¾ã€‚</p>
<p>ç°åœ¨å’±ä»¬æœ‰äº† const æ³›å‹ï¼Œä¹Ÿå°±æ˜¯é’ˆå¯¹å€¼çš„æ³›å‹ï¼Œæ­£å¥½å¯ä»¥ç”¨äºå¤„ç†æ•°ç»„é•¿åº¦çš„é—®é¢˜ï¼š</p>
<pre><pre class="playground"><code class="language-rust">fn display_array&lt;T: std::fmt::Debug, const N: usize&gt;(arr: [T; N]) {
    println!("{:?}", arr);
}
fn main() {
    let arr: [i32; 3] = [1, 2, 3];
    display_array(arr);

    let arr: [i32; 2] = [1, 2];
    display_array(arr);
}</code></pre></pre>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±»å‹ä¸º [T; N] çš„æ•°ç»„ï¼Œå…¶ä¸­ T æ˜¯ä¸€ä¸ªåŸºäºç±»å‹çš„æ³›å‹å‚æ•°ï¼Œè¿™ä¸ªå’Œä¹‹å‰è®²çš„æ³›å‹æ²¡æœ‰åŒºåˆ«ï¼Œè€Œé‡ç‚¹åœ¨äº N è¿™ä¸ªæ³›å‹å‚æ•°ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºå€¼çš„æ³›å‹å‚æ•°ï¼å› ä¸ºå®ƒç”¨æ¥æ›¿ä»£çš„æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚</p>
<p>N å°±æ˜¯ const æ³›å‹ï¼Œå®šä¹‰çš„è¯­æ³•æ˜¯ const N: usizeï¼Œè¡¨ç¤º const æ³›å‹ N ï¼Œå®ƒåŸºäºçš„å€¼ç±»å‹æ˜¯ usizeã€‚</p>
<h4 id="const-æ³›å‹è¡¨è¾¾å¼"><a class="header" href="#const-æ³›å‹è¡¨è¾¾å¼">const æ³›å‹è¡¨è¾¾å¼</a></h4>
<p>å‡è®¾æˆ‘ä»¬æŸæ®µä»£ç éœ€è¦åœ¨å†…å­˜å¾ˆå°çš„å¹³å°ä¸Šå·¥ä½œï¼Œå› æ­¤éœ€è¦é™åˆ¶å‡½æ•°å‚æ•°å ç”¨çš„å†…å­˜å¤§å°ï¼Œæ­¤æ—¶å°±å¯ä»¥ä½¿ç”¨ const æ³›å‹è¡¨è¾¾å¼æ¥å®ç°ï¼š</p>
<pre><pre class="playground"><code class="language-rust">// ç›®å‰åªèƒ½åœ¨nightlyç‰ˆæœ¬ä¸‹ä½¿ç”¨
#![allow(incomplete_features)]
#![feature(generic_const_exprs)]

fn something&lt;T&gt;(val: T)
where
    Assert&lt;{ core::mem::size_of::&lt;T&gt;() &lt; 768 }&gt;: IsTrue,
    //       ^-----------------------------^ è¿™é‡Œæ˜¯ä¸€ä¸ª const è¡¨è¾¾å¼ï¼Œæ¢æˆå…¶å®ƒçš„ const è¡¨è¾¾å¼ä¹Ÿå¯ä»¥
{
    //
}

fn main() {
    something([0u8; 0]); // ok
    something([0u8; 512]); // ok
    something([0u8; 1024]); // ç¼–è¯‘é”™è¯¯ï¼Œæ•°ç»„é•¿åº¦æ˜¯1024å­—èŠ‚ï¼Œè¶…è¿‡äº†768å­—èŠ‚çš„å‚æ•°é•¿åº¦é™åˆ¶
}

// ---

pub enum Assert&lt;const CHECK: bool&gt; {
    //
}

pub trait IsTrue {
    //
}

impl IsTrue for Assert&lt;true&gt; {
    //
}</code></pre></pre>
<h4 id="ä¸ºä»€ä¹ˆéœ€è¦-const-fn"><a class="header" href="#ä¸ºä»€ä¹ˆéœ€è¦-const-fn">ä¸ºä»€ä¹ˆéœ€è¦ const fn</a></h4>
<p>æœ‰äº† const fnï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¼–è¯‘æœŸæ‰§è¡Œè¿™äº›å‡½æ•°ï¼Œä»è€Œå°†è®¡ç®—ç»“æœç›´æ¥åµŒå…¥åˆ°ç”Ÿæˆçš„ä»£ç ä¸­ã€‚è¿™ä¸ä»…ä»¥é«˜äº†è¿è¡Œæ—¶çš„æ€§èƒ½ï¼Œè¿˜ä½¿ä»£ç æ›´åŠ ç®€æ´å’Œå®‰å…¨ã€‚</p>
<pre><pre class="playground"><code class="language-rust">const fn add(a: usize, b: usize) -&gt; usize {
    a + b
}

const RESULT: usize = add(5, 10);

fn main() {
    println!("The result is: {}", RESULT);
}</code></pre></pre>
<h4 id="ç»“åˆ-const-fn-ä¸-const-æ³›å‹"><a class="header" href="#ç»“åˆ-const-fn-ä¸-const-æ³›å‹">ç»“åˆ const fn ä¸ const æ³›å‹</a></h4>
<pre><pre class="playground"><code class="language-rust">
struct Buffer&lt;const N: usize&gt; {
    data: [u8; N],
}

const fn compute_buffer_size(factor: usize) -&gt; usize {
    factor * 1024
}

fn main() {
    const SIZE: usize = compute_buffer_size(4);
    let buffer = Buffer::&lt;SIZE&gt; {
        data: [0; SIZE],
    };
    println!("Buffer size: {} bytes", buffer.data.len());
}
</code></pre></pre>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œcompute_buffer_size æ˜¯ä¸€ä¸ªå¸¸é‡å‡½æ•°ï¼Œå®ƒæ ¹æ®ä¼ å…¥çš„ factor è®¡ç®—ç¼“å†²åŒºçš„å¤§å°ã€‚åœ¨ main å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ compute_buffer_size(4) æ¥è®¡ç®—ç¼“å†²åŒºå¤§å°ä¸º 4096 å­—èŠ‚ï¼Œå¹¶å°†å…¶ä½œä¸ºæ³›å‹å‚æ•°ä¼ é€’ç»™ Buffer ç»“æ„ä½“ã€‚è¿™æ ·ï¼Œç¼“å†²åŒºçš„å¤§å°åœ¨ç¼–è¯‘æœŸå°±è¢«ç¡®å®šä¸‹æ¥ï¼Œé¿å…äº†è¿è¡Œæ—¶çš„è®¡ç®—å¼€é”€ã€‚</p>
<h2 id="trait"><a class="header" href="#trait">Trait</a></h2>
<p>trait å®šä¹‰äº†ä¸€ç»„å¯ä»¥è¢«å…±äº«çš„è¡Œä¸ºï¼Œåªè¦å®ç°äº†ç‰¹å¾ï¼Œä½ å°±èƒ½ä½¿ç”¨è¿™ç»„è¡Œä¸ºã€‚å¦‚æœä¸åŒçš„ç±»å‹å…·æœ‰ç›¸åŒçš„è¡Œä¸ºï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å®šä¹‰ä¸€ä¸ªç‰¹å¾ï¼Œç„¶åä¸ºè¿™äº›ç±»å‹å®ç°è¯¥ç‰¹å¾ã€‚</p>
<p>ç‰¹å¾åªå®šä¹‰è¡Œä¸ºçœ‹èµ·æ¥æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œè€Œä¸å®šä¹‰è¡Œä¸ºå…·ä½“å®ç°ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªå®šä¹‰ç‰¹å¾æ–¹æ³•çš„ç­¾åï¼Œè€Œä¸è¿›è¡Œå®ç°ï¼Œæ­¤æ—¶æ–¹æ³•ç­¾åç»“å°¾æ˜¯ ;ï¼Œè€Œä¸æ˜¯ä¸€ä¸ª {}ã€‚</p>
<pre><pre class="playground"><code class="language-rust">pub trait Summary {
    fn summarize(&amp;self) -&gt; String;
}
pub struct Post {
    pub title: String, // æ ‡é¢˜
    pub author: String, // ä½œè€…
    pub content: String, // å†…å®¹
}

impl Summary for Post {
    fn summarize(&amp;self) -&gt; String {
        format!("æ–‡ç« {}, ä½œè€…æ˜¯{}", self.title, self.author)
    }
}

pub struct Weibo {
    pub username: String,
    pub content: String
}

impl Summary for Weibo {
    fn summarize(&amp;self) -&gt; String {
        format!("{}å‘è¡¨äº†å¾®åš{}", self.username, self.content)
    }
}

fn main() {
    let post = Post{title: "Rustè¯­è¨€ç®€ä»‹".to_string(),author: "Sunface".to_string(), content: "Rustæ£’æäº†!".to_string()};
    let weibo = Weibo{username: "sunface".to_string(),content: "å¥½åƒå¾®åšæ²¡Tweetå¥½ç”¨".to_string()};

    println!("{}",post.summarize());
    println!("{}",weibo.summarize());
}

// æ–‡ç«  Rust è¯­è¨€ç®€ä»‹, ä½œè€…æ˜¯Sunface
// sunfaceå‘è¡¨äº†å¾®åšå¥½åƒå¾®åšæ²¡Tweetå¥½ç”¨</code></pre></pre>
<h3 id="ç‰¹å¾å®šä¹‰ä¸å®ç°çš„ä½ç½®å­¤å„¿è§„åˆ™"><a class="header" href="#ç‰¹å¾å®šä¹‰ä¸å®ç°çš„ä½ç½®å­¤å„¿è§„åˆ™">ç‰¹å¾å®šä¹‰ä¸å®ç°çš„ä½ç½®(å­¤å„¿è§„åˆ™)</a></h3>
<p>å…³äºç‰¹å¾å®ç°ä¸å®šä¹‰çš„ä½ç½®ï¼Œæœ‰ä¸€æ¡éå¸¸é‡è¦çš„åŸåˆ™ï¼šå¦‚æœä½ æƒ³è¦ä¸ºç±»å‹ A å®ç°ç‰¹å¾ Tï¼Œé‚£ä¹ˆ A æˆ–è€… T è‡³å°‘æœ‰ä¸€ä¸ªæ˜¯åœ¨å½“å‰ä½œç”¨åŸŸä¸­å®šä¹‰çš„ï¼ ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥ä¸ºä¸Šé¢çš„ Post ç±»å‹å®ç°æ ‡å‡†åº“ä¸­çš„ Display ç‰¹å¾ï¼Œè¿™æ˜¯å› ä¸º Post ç±»å‹å®šä¹‰åœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨å½“å‰åŒ…ä¸­ä¸º String ç±»å‹å®ç° Summary ç‰¹å¾ï¼Œå› ä¸º Summary å®šä¹‰åœ¨å½“å‰ä½œç”¨åŸŸä¸­ã€‚</p>
<p>ä½†æ˜¯ä½ æ— æ³•åœ¨å½“å‰ä½œç”¨åŸŸä¸­ï¼Œä¸º String ç±»å‹å®ç° Display ç‰¹å¾ï¼Œå› ä¸ºå®ƒä»¬ä¿©éƒ½å®šä¹‰åœ¨æ ‡å‡†åº“ä¸­ï¼Œå…¶å®šä¹‰æ‰€åœ¨çš„ä½ç½®éƒ½ä¸åœ¨å½“å‰ä½œç”¨åŸŸï¼Œè·Ÿä½ åŠæ¯›é’±å…³ç³»éƒ½æ²¡æœ‰ï¼Œçœ‹çœ‹å°±è¡Œäº†ã€‚</p>
<p>è¯¥è§„åˆ™è¢«ç§°ä¸ºå­¤å„¿è§„åˆ™ï¼Œå¯ä»¥ç¡®ä¿å…¶å®ƒäººç¼–å†™çš„ä»£ç ä¸ä¼šç ´åä½ çš„ä»£ç ï¼Œä¹Ÿç¡®ä¿äº†ä½ ä¸ä¼šè«åå…¶å¦™å°±ç ´åäº†é£é©¬ç‰›ä¸ç›¸åŠçš„ä»£ç ã€‚</p>
<h3 id="é»˜è®¤å®ç°"><a class="header" href="#é»˜è®¤å®ç°">é»˜è®¤å®ç°</a></h3>
<p>ä½ å¯ä»¥åœ¨ç‰¹å¾ä¸­å®šä¹‰å…·æœ‰é»˜è®¤å®ç°çš„æ–¹æ³•ï¼Œè¿™æ ·å…¶å®ƒç±»å‹æ— éœ€å†å®ç°è¯¥æ–¹æ³•ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥é€‰æ‹©é‡è½½è¯¥æ–¹æ³•ï¼š</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span>
<span class="boring">fn main() {
</span>pub trait Summary {
    fn summarize(&amp;self) -&gt; String {
        String::from("(Read more...)")
    }
}

impl Summary for Post {}
impl Summary for Weibo {
    fn summarize(&amp;self) -&gt; String {
        format!("{}å‘è¡¨äº†å¾®åš{}", self.username, self.content)
    }
}

println!("{}",post.summarize());
println!("{}",weibo.summarize());

// (Read more...)
// sunfaceå‘è¡¨äº†å¾®åšå¥½åƒå¾®åšæ²¡Tweetå¥½ç”¨
<span class="boring">}</span></code></pre></pre>
<h3 id="ä½¿ç”¨ç‰¹å¾ä½œä¸ºå‡½æ•°å‚æ•°"><a class="header" href="#ä½¿ç”¨ç‰¹å¾ä½œä¸ºå‡½æ•°å‚æ•°">ä½¿ç”¨ç‰¹å¾ä½œä¸ºå‡½æ•°å‚æ•°</a></h3>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>pub fn notify(item: &amp;impl Summary) {
    println!("Breaking news! {}", item.summarize());
}

<span class="boring">}</span></code></pre></pre>
<p>impl Summaryï¼Œåªèƒ½è¯´æƒ³å‡ºè¿™ä¸ªç±»å‹çš„äººçœŸçš„æ˜¯èµ·åé¬¼æ‰ï¼Œç®€ç›´å¤ªè´´åˆ‡äº†ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒçš„æ„æ€æ˜¯ å®ç°äº†Summaryç‰¹å¾ çš„ item å‚æ•°ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•å®ç°äº† Summary ç‰¹å¾çš„ç±»å‹ä½œä¸ºè¯¥å‡½æ•°çš„å‚æ•°ï¼ŒåŒæ—¶åœ¨å‡½æ•°ä½“å†…ï¼Œè¿˜å¯ä»¥è°ƒç”¨è¯¥ç‰¹å¾çš„æ–¹æ³•ï¼Œä¾‹å¦‚ summarize æ–¹æ³•ã€‚å…·ä½“çš„è¯´ï¼Œå¯ä»¥ä¼ é€’ Post æˆ– Weibo çš„å®ä¾‹æ¥ä½œä¸ºå‚æ•°ï¼Œè€Œå…¶å®ƒç±»å¦‚ String æˆ–è€… i32 çš„ç±»å‹åˆ™ä¸èƒ½ç”¨åšè¯¥å‡½æ•°çš„å‚æ•°ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰å®ç° Summary ç‰¹å¾ã€‚</p>
<h3 id="ç‰¹å¾çº¦æŸtrait-bound"><a class="header" href="#ç‰¹å¾çº¦æŸtrait-bound">ç‰¹å¾çº¦æŸ(trait bound)</a></h3>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
